<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Discovering Statistics Using R - 008</title>
		<link rel="stylesheet" href="/assets/css/default.css">
		<link rel="stylesheet" href="/assets/css/code.css">
		<link rel="icon" type="image/png" href="/assets/favicon/favicon.ico">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		<!-- head.html 또는 기본 레이아웃 파일에 추가 -->
		<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css' rel='stylesheet' />
		<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js'></script>
	</head>
  <body>
      <div class = "header">
  <div class = "blog_image">
    <img src="/assets/images/coffee.png" title="coffee">
  </div>
  <div class = "main_text">
    <h1><a href='/'>In수</a></h1>
  </div>

  <!-- 원하는 위치에 시계를 삽입 -->
  <div id="clock"></div>
</div>

<script>
  function startTime() {
    const today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    setTimeout(startTime, 1000);
  }

  function checkTime(i) {
    if (i < 10) { i = "0" + i };  // 10보다 작으면 앞에 0을 추가
    return i;
  }

  // 페이지 로드 시 시계 시작
  document.addEventListener('DOMContentLoaded', startTime);
</script>

			<div class="container">
			  <div class="navigation">
					<ul>
					  
					    <li><a href="/index.html">HOME</a></li>
					  
					    <li><a href="/posts/index.html">POSTS</a></li>
					  
					    <li><a href="/tags.html">TAGS</a></li>
					  
					    <li><a href="/books.html">BOOKS</a></li>
					  
					    <li><a href="/project.html">PROJECT</a></li>
					  
					</ul>
					<div id="music-controls" style="text-align: center;">
					    <img id="musicGif" src="https://cdn.pixabay.com/animation/2022/12/05/15/23/15-23-06-837_512.gif" alt="Music GIF" style="display: inline-block; width: 50px; height: 50px; margin-top: 21px;">
					    <button id="playButton" onclick="playMusic()" style="font-size: 0.6vw;">Play</button>
					    <button id="pauseButton" onclick="pauseMusic()" style="font-size: 0.6vw;">Pause</button>
					    <button id="nextButton" onclick="nextMusic()" style="font-size: 0.6vw;">Next</button>
							<label for="volumeSlider" style="font-size: 0.6vw; margin-top: 10px;">Volume:</label>
    					<input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1" style="width: 50%; margin-top: 10px;">
					</div>
			  </div>
			  <div class="main">
					<div class="markdown-body">
  <div class="md-content">
    <h1 id="discovering-statistics-using-r---008---2024년12월10일">Discovering Statistics Using R - 008 - 2024년12월10일</h1>

<!-- - tag : Discovering_Statistics_Using_R R  -->
<ul>
  <li>tag : <a href="/tags/tag_Discovering_Statistics_Using_R.html" class="btn btn-default navbar-btn cursorNorm" role="button">Discovering_Statistics_Using_R</a>
|
<a href="/tags/tag_R.html" class="btn btn-default navbar-btn cursorNorm" role="button">R</a>
|</li>
</ul>

<hr />

<h1 id="로지스틱-회귀">로지스틱 회귀</h1>

<blockquote>
  <p>로지스틱 회귀란 결과변수가 범주형변수이고 예측변수들이 연속변수 또는 범주형변수인 다중회귀이다.<br />
로지스틱 회귀에서는 Y의 값이 이미 알고 있는 \(X_1\)의 값(또는 X의 값들)일 확률을 예측한다.</p>
</blockquote>

<ul>
  <li>로지스틱 회귀 방정식
    <blockquote>
\[P(Y) = \frac{1}{1 + e^{-(b_0+b_1X_{1i}+b_2X_{2i}+...+b_nX_{ni})}}\]
    </blockquote>
  </li>
</ul>

<h2 id="모형의-평가">모형의 평가</h2>

<ol>
  <li>로그 가능도 통계량
    <blockquote>
      <p>로그 가능도는 예측값들과 실체 관측값들에 관한 확률들의 합이다.<br />
로그 가능도 통계량의 값이 크다는 것은 설명되지 않은 관측이 많이 남아 있다는 뜻으로, 그런 경우 해당 통계적 모형은 자료에 적합하지 않다.</p>
    </blockquote>
  </li>
  <li>이탈도(deviance) 통계량
    <blockquote>
      <p>이탈도는 카이제곱 분포를 따르기 때문에 로그 가능도를 그냥 사용하는 것보다 사용하기 편하다. -&gt; 유의성을 계산하기가 쉽다.</p>
    </blockquote>
  </li>
  <li>\(R과 R^2\)
    <blockquote>
      <p>모형이 자료에 얼마나 잘 들어맞는지를 측정하는데 사용하는 측도<br />
R-statistic : 결과변수와 각 예측변수 사이의 편상관계수로, 값의 범위는 -1부터 1까지</p>
    </blockquote>
  </li>
  <li>z 통계량
    <blockquote>
      <p>정규분포를 따르며, 주어진 예측변수의 b 계수가 0과 유의하게 다른지의 여부를 나타낸다.</p>
    </blockquote>
  </li>
  <li>승산비(odds ratio; 오즈비)
    <blockquote>
      <p>예측변수의 1단위 변화에 따른 승산의 변화 비율</p>
    </blockquote>
  </li>
</ol>

<h2 id="로지스틱-회귀-방법">로지스틱 회귀 방법</h2>

<h3 id="강제-도입법">강제 도입법</h3>

<blockquote>
  <p>예측변수들을 모두 한꺼번에 회귀모형에 포함하고 각 예측변수의 매개변수들을 추정하는 방법</p>
</blockquote>

<h3 id="단계적-방법">단계적 방법</h3>

<blockquote>
  <p>(전진, 후진, 또는 둘의 조합)을 선택해야 함.<br />
매개변수의 변화가 있을 때 마다 AIC, BIC 중 선택한 기준을 이용해서 개선되었는지 확인</p>
</blockquote>

<h2 id="가정">가정</h2>

<ol>
  <li>선형성 : 임의의 연속 예측변수들과 결과변수의 로짓의 관계가 선형이라는 가정</li>
  <li>오차의 독립성 : 자료의 사례들 사이에 관계가 없어야 함</li>
  <li>다중공선성의 부재 : 예측변수들 사이의 상관관계가 너무 크면 안된다.</li>
</ol>

<h2 id="r을-이용한-로지스틱-회귀">R을 이용한 로지스틱 회귀</h2>

<h3 id="이항-로지스틱-회귀">이항 로지스틱 회귀</h3>

<h4 id="intervention">Intervention</h4>

<ul>
  <li>결과변수 : Cured[치료됨 or 치료되지 않음]</li>
  <li>예측변수
    <ol>
      <li>Intervention : 개입했음, 처치가 없었음</li>
      <li>Duration : 환자가 처치를 받기 전까지 문제를 겪은 기간, 단위는 일</li>
    </ol>
  </li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">eelData</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">
      </span><span class="n">Cured</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="n">Duration</span><span class="w">
</span><span class="m">1</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">7</span><span class="w">
</span><span class="m">2</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">7</span><span class="w">
</span><span class="m">3</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">6</span><span class="w">
</span><span class="m">4</span><span class="w">     </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">8</span><span class="w">
</span><span class="m">5</span><span class="w">     </span><span class="n">Cured</span><span class="w"> </span><span class="n">Intervention</span><span class="w">        </span><span class="m">7</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>변수를 요인으로 변경 후 기저를 부정인 값으로 지정</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">eelData</span><span class="o">$</span><span class="n">Cured</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">eelData</span><span class="o">$</span><span class="n">Cured</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">eelData</span><span class="o">$</span><span class="n">Intervention</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">eelData</span><span class="o">$</span><span class="n">Intervention</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">eelData</span><span class="o">$</span><span class="n">Cured</span><span class="o">&lt;-</span><span class="n">relevel</span><span class="p">(</span><span class="n">eelData</span><span class="o">$</span><span class="n">Cured</span><span class="p">,</span><span class="w"> </span><span class="s2">"Not Cured"</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">eelData</span><span class="o">$</span><span class="n">Intervention</span><span class="o">&lt;-</span><span class="n">relevel</span><span class="p">(</span><span class="n">eelData</span><span class="o">$</span><span class="n">Intervention</span><span class="p">,</span><span class="w"> </span><span class="s2">"No Treatment"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>glm : generalized linear model</li>
  <li>glm(결과변수 ~ 예측변수(들), data = 데이터프레임, family = 분포의 종류, na.action = 결측값처리방식)</li>
  <li>family : binomial() -&gt; 로지스틱 회귀는 이항분포에 기초하므로 이렇게 지정해야 함</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">eelModel.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eelData</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>모형의 전반적인 적합도는 이탈도로 평가. [ 이 값이 클수록 통계적 모형으로서의 이 회귀모형은 자료에 잘 적합되지 않는 것 ]</li>
  <li>귀무 이탈도(null deviance) : 상수만 있고 예측 변수는 전혀 없는 모형의 이탈도 [ = -2LL(기저모형) = 154.08 ]</li>
  <li>잔차 이탈도를 제공 : -2LL(새모형) [ 144.16 ]</li>
  <li>기저 이탈도(154.08)에서 Intervention을 추가(144.16)하니 이탈도가 감소했다. -&gt; 추가한 모형이 결과를 좀 더 잘 예측함</li>
  <li>모형이 결과변수를 ‘얼마나 더 잘’예측하는지는 모형의 카이제곱 통계량으로 평가[카이제곱 : 현재의 모형과 상수만 있는 모형의 차이를 측정]</li>
  <li>Z통계량의 유의확률이 0.05보다 작으므로 Intervention은 치료 여부의 유의한 예측변수라고 할 수 있다.</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">glm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">(),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eelData</span><span class="p">)</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
                         </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span><span class="w">   
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">               </span><span class="m">-0.2877</span><span class="w">     </span><span class="m">0.2700</span><span class="w">  </span><span class="m">-1.065</span><span class="w">  </span><span class="m">0.28671</span><span class="w">   
</span><span class="n">InterventionIntervention</span><span class="w">   </span><span class="m">1.2287</span><span class="w">     </span><span class="m">0.3998</span><span class="w">   </span><span class="m">3.074</span><span class="w">  </span><span class="m">0.00212</span><span class="w"> </span><span class="o">**</span><span class="w">
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="p">(</span><span class="n">Dispersion</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">binomial</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

    </span><span class="n">Null</span><span class="w"> </span><span class="n">deviance</span><span class="o">:</span><span class="w"> </span><span class="m">154.08</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="m">112</span><span class="w">  </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">Residual</span><span class="w"> </span><span class="n">deviance</span><span class="o">:</span><span class="w"> </span><span class="m">144.16</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="m">111</span><span class="w">  </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">AIC</span><span class="o">:</span><span class="w"> </span><span class="m">148.16</span><span class="w">

</span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Fisher</span><span class="w"> </span><span class="n">Scoring</span><span class="w"> </span><span class="n">iterations</span><span class="o">:</span><span class="w"> </span><span class="m">4</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>카이제곱 = 154.08 - 144.16 = 9.92 [ 이 값은 카이제곱 분포를 따르므로, 유의성을 확인하면 &lt; 0.05 수준에서 유의하므로 상수만 있는 모형보다 이 모형이 더 잘 예측한다고 할 수 있다.]</li>
  <li>모형에 Intervention을 포함 함으로써 모형의 적합도가 \(\chi^2(1) = 9.93, p = 0.002\)로 유의하게 개선되었다는 결론을 내릴 수 있다.</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">modelChi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eelModel.1</span><span class="o">$</span><span class="n">null.deviance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eelModel.1</span><span class="o">$</span><span class="n">deviance</span><span class="w"> </span><span class="c1"># 카이제곱 구하기</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">chidf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">eelModel.1</span><span class="o">$</span><span class="n">df.null</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eelModel.1</span><span class="o">$</span><span class="n">df.residual</span><span class="w"> </span><span class="c1"># 통계량의 자유도 구하기</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">chisq.prob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pchisq</span><span class="p">(</span><span class="n">modelChi</span><span class="p">,</span><span class="w"> </span><span class="n">chidf</span><span class="p">)</span><span class="w"> </span><span class="c1"># 카이제곱 통계량과 관련된 확률 구하기</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">modelChi</span><span class="p">;</span><span class="w"> </span><span class="n">chidf</span><span class="p">;</span><span class="w"> </span><span class="n">chisq.prob</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">9.926201</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">0.001629425</span><span class="w"> </span><span class="c1"># &lt; 0.05 이므로 모형이 결과를 더 잘 예측하지 못한다는 귀무가설을 기각할 수 있다.</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">eelModel.1</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span><span class="w"> </span><span class="c1"># 승산비 구하기</span><span class="w">
             </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="n">InterventionIntervention</span><span class="w">
                </span><span class="m">0.750000</span><span class="w">                 </span><span class="m">3.416667</span><span class="w">
</span><span class="c1"># 결론 : 처치를 받은 환자가 치료될 승산이 처치를 받지 않은 환자가 치료될 승산의 3.42배라고 말할 수 있다.</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">confint</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">))</span><span class="w"> </span><span class="c1"># 승산비들의 신뢰구간</span><span class="w">
                             </span><span class="m">2.5</span><span class="w"> </span><span class="o">%   97.5 %</span><span class="w">
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">              </span><span class="m">0.4374531</span><span class="w"> </span><span class="m">1.268674</span><span class="w">
</span><span class="n">InterventionIntervention</span><span class="w"> </span><span class="m">1.5820127</span><span class="w"> </span><span class="m">7.625545</span><span class="w">
</span><span class="c1"># 결과에서 중요한 점은 하계와 상계의 값이 1보다 크다는 점</span><span class="w">
</span><span class="c1"># 왜냐하면, 예측변수가 증가함에 따라 환자가 치료될 승산이 커짐을 뜻하기 때문이다.</span><span class="w">
</span><span class="c1"># 만약 하계가 1보다 작다면, 모집단에서의 관계의 방향이 관측된 방향과 다를 여지가 존재하는 것 -&gt; 실험자의 개입이 환자가 치료될 승산을 증가한다고 확신할 수 없다.</span><span class="w">
</span></code></pre></div></div>

<h3 id="intervention-and-duration">Intervention and Duration</h3>

<ul>
  <li>Duration의 b 추정값이 0.008으로 꽤 작은 값이며, 그 변수에 관련된 확률은 0.964 &gt; 0.05이므로 이 값은 유의하지 않다.</li>
  <li>두 모형의 이탈도(=144.16)으로 똑같고, AIC(150.16)으로 모형 1의 값(148.16)보다 큰 값으로, 이는 모형 1이 더 나은 모형임을 뜻한다.</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">eelModel.2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eelData</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">())</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">eelModel.2</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">glm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">(),</span><span class="w">
    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eelData</span><span class="p">)</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
                          </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span><span class="w">   
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">              </span><span class="m">-0.234660</span><span class="w">   </span><span class="m">1.220563</span><span class="w">  </span><span class="m">-0.192</span><span class="w">  </span><span class="m">0.84754</span><span class="w">   
</span><span class="n">InterventionIntervention</span><span class="w">  </span><span class="m">1.233532</span><span class="w">   </span><span class="m">0.414565</span><span class="w">   </span><span class="m">2.975</span><span class="w">  </span><span class="m">0.00293</span><span class="w"> </span><span class="o">**</span><span class="w">
</span><span class="n">Duration</span><span class="w">                 </span><span class="m">-0.007835</span><span class="w">   </span><span class="m">0.175913</span><span class="w">  </span><span class="m">-0.045</span><span class="w">  </span><span class="m">0.96447</span><span class="w">   
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="p">(</span><span class="n">Dispersion</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">binomial</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

    </span><span class="n">Null</span><span class="w"> </span><span class="n">deviance</span><span class="o">:</span><span class="w"> </span><span class="m">154.08</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="m">112</span><span class="w">  </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">Residual</span><span class="w"> </span><span class="n">deviance</span><span class="o">:</span><span class="w"> </span><span class="m">144.16</span><span class="w">  </span><span class="n">on</span><span class="w"> </span><span class="m">110</span><span class="w">  </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">AIC</span><span class="o">:</span><span class="w"> </span><span class="m">150.16</span><span class="w">

</span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Fisher</span><span class="w"> </span><span class="n">Scoring</span><span class="w"> </span><span class="n">iterations</span><span class="o">:</span><span class="w"> </span><span class="m">4</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>두 모형을 비교하는 방법</li>
  <li>두 모형의 이탈도 차이는 0.00198이며 자유도 차이는 1이다.</li>
  <li>p값은 0.9645 &gt; 0.05이므로 모형1보다 유의하게 개선된 것은 아니라는 결론을 내릴 수 있다.</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">anova</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">,</span><span class="w"> </span><span class="n">eelModel.2</span><span class="p">)</span><span class="w">
</span><span class="n">Analysis</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Deviance</span><span class="w"> </span><span class="n">Table</span><span class="w">

</span><span class="n">Model</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="w">
</span><span class="n">Model</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span><span class="w">
  </span><span class="n">Resid.</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">Resid.</span><span class="w"> </span><span class="n">Dev</span><span class="w"> </span><span class="n">Df</span><span class="w">  </span><span class="n">Deviance</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">Chi</span><span class="p">)</span><span class="w">
</span><span class="m">1</span><span class="w">       </span><span class="m">111</span><span class="w">     </span><span class="m">144.16</span><span class="w">                      
</span><span class="m">2</span><span class="w">       </span><span class="m">110</span><span class="w">     </span><span class="m">144.16</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">0.0019835</span><span class="w">   </span><span class="m">0.9645</span><span class="w">
</span></code></pre></div></div>

<h3 id="로지스틱-회귀의-사례별-진단">로지스틱 회귀의 사례별 진단</h3>

<ul>
  <li>기본적인 진단 통계량 구하는 코드</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eelData</span><span class="o">$</span><span class="n">predicted.probabilities</span><span class="o">&lt;-</span><span class="n">fitted</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span><span class="n">eelData</span><span class="o">$</span><span class="n">standardized.residuals</span><span class="o">&lt;-</span><span class="n">rstandard</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span><span class="n">eelData</span><span class="o">$</span><span class="n">studentized.residuals</span><span class="o">&lt;-</span><span class="n">rstudent</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span><span class="n">eelData</span><span class="o">$</span><span class="n">dfbeta</span><span class="o">&lt;-</span><span class="n">dfbeta</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span><span class="n">eelData</span><span class="o">$</span><span class="n">dffit</span><span class="o">&lt;-</span><span class="n">dffits</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span><span class="n">eelData</span><span class="w"> </span><span class="o">$</span><span class="n">leverage</span><span class="o">&lt;-</span><span class="n">hatvalues</span><span class="p">(</span><span class="n">eelModel.1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>예측변수 : Intervention</li>
  <li>환자가 처치를 받지 않았을 때 치료될 확률은 0.429, 개입이 있었다면 환자가 치료될 확률은 0.719</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">eelData</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Cured"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Intervention"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Duration"</span><span class="p">,</span><span class="w"> </span><span class="s2">"predicted.probabilities"</span><span class="p">)],</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w">
      </span><span class="n">Cured</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="n">Duration</span><span class="w"> </span><span class="n">predicted.probabilities</span><span class="w">
</span><span class="m">1</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">7</span><span class="w">               </span><span class="m">0.4285714</span><span class="w">
</span><span class="m">2</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">7</span><span class="w">               </span><span class="m">0.4285714</span><span class="w">
</span><span class="m">3</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">6</span><span class="w">               </span><span class="m">0.4285714</span><span class="w">
</span><span class="m">4</span><span class="w">     </span><span class="n">Cured</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Treatment</span><span class="w">        </span><span class="m">8</span><span class="w">               </span><span class="m">0.4285714</span><span class="w">
</span><span class="m">5</span><span class="w">     </span><span class="n">Cured</span><span class="w"> </span><span class="n">Intervention</span><span class="w">        </span><span class="m">7</span><span class="w">               </span><span class="m">0.7192982</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>잔차 통계량을 확인했을 때 확인해야 할 사항
    <ol>
      <li>지렛대</li>
      <li>스튜던트화 잔차와 표준화잔차</li>
      <li>상수의 DFBeta와 예측변수의 DFBeta</li>
    </ol>
  </li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">eelData</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"leverage"</span><span class="p">,</span><span class="w"> </span><span class="s2">"studentized.residuals"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dfbeta"</span><span class="p">)],</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w">
    </span><span class="n">leverage</span><span class="w"> </span><span class="n">studentized.residuals</span><span class="w"> </span><span class="n">dfbeta.</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="n">dfbeta.InterventionIntervention</span><span class="w">
</span><span class="m">1</span><span class="w"> </span><span class="m">0.01785714</span><span class="w">            </span><span class="m">-1.0643627</span><span class="w">        </span><span class="m">-0.03886912</span><span class="w">                      </span><span class="m">0.03886912</span><span class="w">
</span><span class="m">2</span><span class="w"> </span><span class="m">0.01785714</span><span class="w">            </span><span class="m">-1.0643627</span><span class="w">        </span><span class="m">-0.03886912</span><span class="w">                      </span><span class="m">0.03886912</span><span class="w">
</span><span class="m">3</span><span class="w"> </span><span class="m">0.01785714</span><span class="w">            </span><span class="m">-1.0643627</span><span class="w">        </span><span class="m">-0.03886912</span><span class="w">                      </span><span class="m">0.03886912</span><span class="w">
</span><span class="m">4</span><span class="w"> </span><span class="m">0.01785714</span><span class="w">             </span><span class="m">1.3110447</span><span class="w">         </span><span class="m">0.04782751</span><span class="w">                     </span><span class="m">-0.04782751</span><span class="w">
</span><span class="m">5</span><span class="w"> </span><span class="m">0.01754386</span><span class="w">             </span><span class="m">0.8160435</span><span class="w">         </span><span class="m">0.00000000</span><span class="w">                      </span><span class="m">0.03225994</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>주의사항! 만약 현저한 이상치 사례들이 발견되었다면, 단지 모형을 좀 더 자료에 적합하게 만들기 위해 사례들을 제거하는 것은 정당한 일이 아니라는 점</li>
</ul>

<h3 id="보고">보고</h3>

<p><img src="/assets/images/Book/Discovering_Statistics_Using_R/table_001.png" alt="image_01" /></p>

  </div>
  <div class="md-index">
    <h2>목차</h2>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#discovering-statistics-using-r---008---2024년12월10일">Discovering Statistics Using R - 008 - 2024년12월10일</a></li>
<li class="toc-entry toc-h1"><a href="#로지스틱-회귀">로지스틱 회귀</a>
<ul>
<li class="toc-entry toc-h2"><a href="#모형의-평가">모형의 평가</a></li>
<li class="toc-entry toc-h2"><a href="#로지스틱-회귀-방법">로지스틱 회귀 방법</a>
<ul>
<li class="toc-entry toc-h3"><a href="#강제-도입법">강제 도입법</a></li>
<li class="toc-entry toc-h3"><a href="#단계적-방법">단계적 방법</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#가정">가정</a></li>
<li class="toc-entry toc-h2"><a href="#r을-이용한-로지스틱-회귀">R을 이용한 로지스틱 회귀</a>
<ul>
<li class="toc-entry toc-h3"><a href="#이항-로지스틱-회귀">이항 로지스틱 회귀</a>
<ul>
<li class="toc-entry toc-h4"><a href="#intervention">Intervention</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#intervention-and-duration">Intervention and Duration</a></li>
<li class="toc-entry toc-h3"><a href="#로지스틱-회귀의-사례별-진단">로지스틱 회귀의 사례별 진단</a></li>
<li class="toc-entry toc-h3"><a href="#보고">보고</a></li>
</ul>
</li>
</ul>
</li>
</ul>
    <hr>
    <h2>관련 POST</h2>
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/25/Discovering-Statistics-Using-R-010.html">Discovering Statistics Using R - 010 [ 2024년12월25일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/12/Discovering-Statistics-Using-R-009.html">Discovering Statistics Using R - 009 [ 2024년12월12일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/10/Discovering-Statistics-Using-R-008.html">Discovering Statistics Using R - 008 [ 2024년12월10일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/06/Discovering-Statistics-Using-R-007.html">Discovering Statistics Using R - 007 [ 2024년12월06일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/05/Discovering-Statistics-Using-R-006.html">Discovering Statistics Using R - 006 [ 2024년12월05일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/04/Discovering-Statistics-Using-R-005.html">Discovering Statistics Using R - 005 [ 2024년12월04일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/03/Discovering-Statistics-Using-R-004.html">Discovering Statistics Using R - 004 [ 2024년12월03일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/30/Discovering-Statistics-Using-R-003.html">Discovering Statistics Using R - 003 [ 2024년11월30일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/29/Discovering-Statistics-Using-R-002.html">Discovering Statistics Using R - 002 [ 2024년11월29일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/28/Discovering-Statistics-Using-R-001.html">Discovering Statistics Using R - 001 [ 2024년11월28일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
  </div>
</div>

<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 56,
  backgroundColor: 'rgb(135, 206, 250)',
  textColor: '#fff'
})</script>

<!-- Latex -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

			  </div>
			</div>
			<div class="footer">
  <p>Email : qkrdlstn9701@naver.com</p>
  <a href="https://github.com/insu97">SITE : GITHUB_PAGE</a>
</div>

  </body>
</html>
<script src="/assets/js/music-controls.js" defer></script>
