<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Discovering Statistics Using R - 007</title>
		<link rel="stylesheet" href="/assets/css/default.css">
		<link rel="stylesheet" href="/assets/css/code.css">
		<link rel="icon" type="image/png" href="/assets/favicon/favicon.ico">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		<!-- head.html 또는 기본 레이아웃 파일에 추가 -->
		<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css' rel='stylesheet' />
		<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js'></script>
	</head>
  <body>
      <div class = "header">
  <div class = "blog_image">
    <img src="/assets/images/coffee.png" title="coffee">
  </div>
  <div class = "main_text">
    <h1><a href='/'>In수</a></h1>
  </div>

  <!-- 원하는 위치에 시계를 삽입 -->
  <div id="clock"></div>
</div>

<script>
  function startTime() {
    const today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    setTimeout(startTime, 1000);
  }

  function checkTime(i) {
    if (i < 10) { i = "0" + i };  // 10보다 작으면 앞에 0을 추가
    return i;
  }

  // 페이지 로드 시 시계 시작
  document.addEventListener('DOMContentLoaded', startTime);
</script>

			<div class="container">
			  <div class="navigation">
					<ul>
					  
					    <li><a href="/index.html">HOME</a></li>
					  
					    <li><a href="/posts/index.html">POSTS</a></li>
					  
					    <li><a href="/tags.html">TAGS</a></li>
					  
					    <li><a href="/books.html">BOOKS</a></li>
					  
					    <li><a href="/project.html">PROJECT</a></li>
					  
					</ul>
					<div id="music-controls" style="text-align: center;">
					    <img id="musicGif" src="https://cdn.pixabay.com/animation/2022/12/05/15/23/15-23-06-837_512.gif" alt="Music GIF" style="display: inline-block; width: 50px; height: 50px; margin-top: 21px;">
					    <button id="playButton" onclick="playMusic()" style="font-size: 0.6vw;">Play</button>
					    <button id="pauseButton" onclick="pauseMusic()" style="font-size: 0.6vw;">Pause</button>
					    <button id="nextButton" onclick="nextMusic()" style="font-size: 0.6vw;">Next</button>
							<label for="volumeSlider" style="font-size: 0.6vw; margin-top: 10px;">Volume:</label>
    					<input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1" style="width: 50%; margin-top: 10px;">
					</div>
			  </div>
			  <div class="main">
					<div class="markdown-body">
  <div class="md-content">
    <h1 id="discovering-statistics-using-r---007---2024년12월06일">Discovering Statistics Using R - 007 - 2024년12월06일</h1>

<!-- - tag : Discovering_Statistics_Using_R R  -->
<ul>
  <li>tag : <a href="/tags/tag_Discovering_Statistics_Using_R.html" class="btn btn-default navbar-btn cursorNorm" role="button">Discovering_Statistics_Using_R</a>
|
<a href="/tags/tag_R.html" class="btn btn-default navbar-btn cursorNorm" role="button">R</a>
|</li>
</ul>

<hr />

<h1 id="회귀">회귀</h1>

<blockquote>
  <p>regression analisys : 하나의 모형을 자료에 적합시키고 그것을 이용해서 하나 이상의 독립변수들로부터 종속변수의 값들을 예측하는 것</p>
</blockquote>

<ul>
  <li>단순 회귀 : 한 예측변수로부터 한 결과변수를 예측한는 것</li>
  <li>다중 회귀 : 여러 개의 예측변수들로부터 한 결과변수를 예측하는 것</li>
</ul>

<blockquote>
  <p>잔차 : 선(=모형)과 실제 자료의 수직 거리<br />
모형이 자료에서 벗어난 정도 = \(\sum(관측값 - 모형)^2\) = \(총제곱합(= SS_T)\) = \(잔차제곱합(=SS_R)\)<br />
\(SS_M\) : Y의 평균값과 회귀선의 차이들로 이루어진다.<br />
\(R^2 = \frac{SS_M}{SS_T}\)<br />
회귀분석인 경우 자유도는 N-P-1 [ N : 표본 크기, P : 예측변수의 개수]</p>
</blockquote>

<h2 id="r을-이용한-회귀분석">R을 이용한 회귀분석</h2>

<h3 id="단순-회귀">단순 회귀</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># lm(결과변수 ~ 예측변수(들), data = dataFrame, na.action = 결측값 처리 방식)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">albumSales.1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album1</span><span class="p">)</span><span class="w">

</span><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">albumSales.1</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">lm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album1</span><span class="p">)</span><span class="w">

</span><span class="n">Residuals</span><span class="o">:</span><span class="w">
     </span><span class="n">Min</span><span class="w">       </span><span class="m">1</span><span class="n">Q</span><span class="w">   </span><span class="n">Median</span><span class="w">       </span><span class="m">3</span><span class="n">Q</span><span class="w">      </span><span class="n">Max</span><span class="w">
</span><span class="m">-152.949</span><span class="w">  </span><span class="m">-43.796</span><span class="w">   </span><span class="m">-0.393</span><span class="w">   </span><span class="m">37.040</span><span class="w">  </span><span class="m">211.866</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
             </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span><span class="w">    
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="m">1.341e+02</span><span class="w">  </span><span class="m">7.537e+00</span><span class="w">  </span><span class="m">17.799</span><span class="w">   </span><span class="o">&lt;</span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="n">adverts</span><span class="w">     </span><span class="m">9.612e-02</span><span class="w">  </span><span class="m">9.632e-03</span><span class="w">   </span><span class="m">9.979</span><span class="w">   </span><span class="o">&lt;</span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="n">Residual</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="w"> </span><span class="m">65.99</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">Multiple</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.3346</span><span class="p">,</span><span class="w">	</span><span class="n">Adjusted</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.3313</span><span class="w">
</span><span class="nb">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span><span class="w"> </span><span class="m">99.59</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="n">DF</span><span class="p">,</span><span class="w">  </span><span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2.2e-16</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>\(R^2\) = 0.3346</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 피어슨 상관계수(R)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">0.3346</span><span class="p">)</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">0.5784462</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>F-statistic: 99.59 on 1 and 198 DF,  p-value: &lt; 2.2e-16
    <blockquote>
      <p>F 비는 99.59 [ 이 값은  p&lt;0.001수준에서 유의하다 ]<br />
이 결과는 만일 귀무가설이 참이라면 이 F비가 나올 확률이 0.1% 미만이라는 뜻<br />
따라서, 회귀모형을 이용해서 음반 판매량을 예측하는 것이 음반 판매량의 평균을 사용해서 판매량을 예측할 때보다 유의하게 더 낫다는 결론을 내릴 수 있다.</p>
    </blockquote>
  </li>
  <li>Pr(&gt;|t|) &lt;2e-16
    <blockquote>
      <p>이 관측 유의확률이 0.05보다 작으면, 그 결과가 진짜 효과를 반영한다는데 동의<br />
따라서, 광고비가 음반 판매량 예측에 유의하게(p &lt; 0.001) 기여한다.</p>
    </blockquote>
  </li>
  <li>$$ 음반 판매량 = b_0 + (b_1 * 광고비) = 134.14 + (0.096 * 광고비_i)</li>
</ul>

<h3 id="다중회귀">다중회귀</h3>

<h4 id="r2-aic">\(R^2, AIC\)</h4>

<blockquote>
  <p>\(결과_i = (모형) + 오차_i\)<br />
\(R^2\)의 큰 문제점은 모형에 변수를 추가할수록 \(R^2\) 값이 점점 커진다는 점<br />
이를 극복하기 위한 수단으로, 아카이케 정보기준(akaike information criterion, AIC)를 사용  : 예측변수가 많을수록 벌점을 준다는 특징이 있다.<br />
\(AIC = nln(\frac{SSE}{n}) + 2k\) -&gt; SSE : 모형의 오차제곱합, k는 예측변수 개수[벌점에 해당]<br />
AIC값이 크다는 것은 모형이 덜 적합하다는 뜻<br />
특이한 점은 AIC 값이 크다 작다를 판단할 수 있는 기준점이 없다는 점, 그리고 같은 자료에 대한 모형들만 비교할 수 있다는 점</p>
</blockquote>

<h4 id="예측변수-선택-방법">예측변수 선택 방법</h4>

<ol>
  <li>위계적 방법
    <blockquote>
      <p>과거 연구에 기초해서 예측변수들을 선택하되, 그 예측변수들을 모형에 도입하는 순서를 실험자가 결정</p>
    </blockquote>
  </li>
  <li>강제 도입법
    <blockquote>
      <p>모든 예측변수를 모형에 동시에 도입하는 것</p>
    </blockquote>
  </li>
  <li>단계별 방법
    <blockquote>
      <p>전진 : 상수(\(b_0\))만 있는 상태로 시작한 후 변수 하나씩 추가하여 AIC를 사용하여 추가할지 판단<br />
후진 : 모든 예측변수를 모형에 추가한 후 변수를 하나씩 제거하면서 AIC가 낮아지는지 확인<br />
단계별 방법을 사용할 때는 후진 방법이 좋다.<br />
이는 억제인자 효과 때문인데, 예측변수가 효과를 가지되 다른 어떤 변수를 고정했을 때만 효과를 가지는 경우에 발생<br />
전진 방향에서는 제2종 오류를 범할 위험이 크다.</p>
    </blockquote>
  </li>
  <li>전부분집합 방법
    <blockquote>
      <p>단계별 방법의 문제점 : 이미 모형에 존재하는 다른 변수들에 기초해서 한 변수의 적합도를 평가<br />
전부분집합 회귀 : 변수들의 모든 집합(부분집합)을 시도해서 최량적합을 찾는다.<br />
단점은 예측변수의 수가 늘어남에 따라 가능한 부분집합의 수가 지수적으로 늘어난다.</p>
    </blockquote>
  </li>
</ol>

<h3 id="회귀모형의-정확도-평가">회귀모형의 정확도 평가</h3>

<ol>
  <li>모형이 자료에 잘 적합하는가?</li>
  <li>모형이 다른 표본들로도 일반화되는가?</li>
</ol>

<h4 id="이상치와-잔차">이상치와 잔차</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IF 이상치가 존재, then 잔차가 큰 값이 존재.
-&gt; 이러한 잔차는 비표준화잔차라고 하는데 이 문제를 극복하기 위해 표준화잔차를 사용
-&gt; 표준화잔차 = 보통의 잔차 / 표준편차 추정값
</code></pre></div></div>

<ul>
  <li>규칙
    <ol>
      <li>크기(절댓값)가 3.29보다 큰 표준화잔차는 문제가 될 수 있다.</li>
      <li>표준화잔차의 크기가 2.58보다 큰 표본 사례들이 전체 표본 사례의 1% 이상이라는 것은 모형의 오차 수준이 받아들일 수 없는 정도라는 증거</li>
      <li>표준화잔차의 크기가 1.96보다 큰 표본 사례가 전체의 5% 이상이라는 것은 모형이 실제 자료를 그리 잘 대표하지 않는다는 것</li>
    </ol>
  </li>
</ul>

<h4 id="영향력이-큰-사례들">영향력이 큰 사례들</h4>

<ul>
  <li>모형의 매개변수들에 지나치게 큰 영향을 주는 사례들을 살펴보기
    <blockquote>
      <p>이런 사례가 있다면, 삭제했을 때 회귀계수들이 달라지는지를 확인해야 한다.</p>
    </blockquote>
  </li>
  <li>수정 예측값(adjusted predicted value) : 해당 사례를 제외한 자료로 만든 모형이 예측한 값
    <blockquote>
      <p>만일 해당 사례가 사실은 모형에 그리 큰 영향을 미치지 않았다면 수정 예측값은 원래의 예측값과 아주 비슷할 것<br />
DFFit : 수정 예측값과 원래의 예측값의 차이</p>
    </blockquote>
  </li>
  <li>제외 잔차 : 수정 예측값에 기초한 잔차</li>
  <li>스튜던트화 잔차 : 제외 잔차를 표준오차로 나누어서 표준화한 값</li>
  <li>쿡의 거리 : 모형에 대한 사례 하나의 전반적인 영향력을 측정한 것 -&gt; 이 거리가 1보다 크면 문제가 될 수 있음을 제시</li>
  <li>hat value(=지렛대(leverage)) : 결과변수의 실제 측정값이 예측값에 미치는 영향을 측정한 것
    <blockquote>
      <p>평균 지렛대 값 = \((k+1) / n\) [ k : 모형의 예측변수 개수, n : 참가자의 수 ]<br />
지렛대 값은 0(사례가 예측에 아무런 영향을 주지 않음) ~ 1(사례가 예측에 완전한 영향을 줌)까지</p>
    </blockquote>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- 중요한 한마디
만일 어떤 점이 Y 축에서 유의한 이상치로 판명되었지만 그 점의 쿡의 거리가 &lt; 1 이면, 그 점은 회귀분석에 큰 영향을 미치지 않으므로 굳이 삭제할 필요가 없다.
그러나, 모형이 그런 점에 적합되지 않은 이유를 이해하기 위해 그런 점을 좀 더 연구할 필요는 있다.
</code></pre></div></div>

<h3 id="회귀모형의-평가--일반화">회귀모형의 평가 : 일반화</h3>

<h4 id="가정-검정">가정 검정</h4>

<ul>
  <li>한 표본으로 얻은 모형으로 어떤 모집단에 관한 결론을 얻으려면 다음과 같은 여러 가정이 성립해야 한다.
    <ol>
      <li>변수의 종류
        <blockquote>
          <p>모든 예측변수는 양적 변수 또는 범주형 변수 이어야 한다.<br />
결과변수는 반드시 연속이자 비유계(unbounded)인 양적 변수이어야 한다.</p>
        </blockquote>
      </li>
      <li>0이 아닌 분산 : 예측변수의 분산이 0이 아니어야 한다.</li>
      <li>완전 다중공선성의 부재 : 둘 이상의 예측변수 사이에 완전한 선형 관계가 없어야 한다.</li>
      <li>‘외부 변수’와는 무관한 예측변수 : 그 어떤 변수도 회귀모형에 포함된 임의의 예측변수와 상관이 없어야 한다는 뜻
        <blockquote>
          <p>결과를 모형만큼이나 잘 예측할 수 있는 다른 변수들이 존재하는 것이므로</p>
        </blockquote>
      </li>
      <li>등분산성 : 예측변수들의 각 수준에서 잔차 항들의 분산이 일정해야 한다.</li>
      <li>오차의 독립성 : 임의의 두 관측값의 잔차들이 무관해야 한다.(즉, 독립적이여야 한다.)
        <blockquote>
          <p>이를 자기상관(autocorrelation)이 없다고 말한다.<br />
오차들의 이연상관을 검사하는 더빈-왓슨 검정으로 확인할 수 있다.</p>
        </blockquote>
      </li>
      <li>오차의 정규분포 : 모형의 잔차들이 평균이 0인 정규분포를 따르는 무작위 값</li>
      <li>독립성 : 이 가정은 결과변수의 모든 값이 독립적이여야 한다.</li>
      <li>선형성 : 예측변수의 값이 증가함에 따라 결과변수의 평균값들이 하나의 직선을 형성해야 한다.</li>
    </ol>
  </li>
</ul>

<h4 id="모형의-교차-타당성-검증">모형의 교차 타당성 검증</h4>

<ul>
  <li>수정 \(R^2\) : 예측 능력의 손실정도를 나타낸다.
    <blockquote>
      <p>\(R^2\) 값이 표본에서 얻은 회귀모형이 Y의 변동을 얼마나 설명하는지 말해주는 값<br />
수정 \(R^2\) 값은 만일 표본이 얻은 모집단으로부터 회귀모형을 유도했다면 그 모형이 Y의 변동을 얼마나 설명할 것인지를 말해주는 값<br />
R은 훼리 방정식을 통해 수정된 \(R^2\) 값을 계산해주는데 이 공식은 회귀모형이 완전히 다른 자료 집합을 얼마나 잘 예측할 것인지에 관해서는 아무것도 말해주지 않는다.<br />
따라서 스타인의 공식을 사용한다. -&gt; \(수정 R^2 = 1 - [(\frac{n-1}{n-k-1})(\frac{n-2}{n-k-2})(\frac{n+1}{n})](1-R^2)\) | n : 참가자의 수, k : 모형의 예측변수의 개수</p>
    </blockquote>
  </li>
</ul>

<h4 id="표본의-개수">표본의 개수</h4>

<ul>
  <li>최소 표본 크기에 관한 일반 규칙
    <ol>
      <li>회귀모형의 전반적인 적합도를 검사할 때[Ex. \(R^2\)] -&gt; 50 + 8k [ k : 예측변수의 개수]</li>
      <li>모형의 개별 예측변수를 검사할 때[Ex. b값] -&gt; 104 + k
        <blockquote>
          <p>둘 다 관심이 있다면 큰 값을 사용하면 OK</p>
        </blockquote>
      </li>
    </ol>
  </li>
</ul>

<h4 id="공선성">공선성</h4>

<ul>
  <li>다중공선성 : 회귀모형에 있는 둘 이상의 예측변수들 사이에 강한 상관관계가 존재하는 것
    <blockquote>
      <p>만약 하나의 예측변수가 다른 어떤 예측변수와 완벽한 선형관계일 때 완전공선성이 존재한다고 말한다.</p>
    </blockquote>
  </li>
  <li>공선성이 높으면 생기는 문제점
    <ol>
      <li>b들을 믿을 수 없게 된다.</li>
      <li>R의 크기가 제한된다.</li>
      <li>예측변수들의 중요도 평가가 어렵다.
        <blockquote>
          <p>해결법 : 분산팽창인자(variance inflation factor, VIF) : 주어진 한 예측변수가 다른 예측변수(들)와 강한 선형 관계를 가지고 있는지를 말한다.<br />
VIF값이 10 이상이라면 걱정할 필요가 있다고 제시<br />
또한, 만일 평균 VIF값이 1보다 크면 다중공선성 때문에 회귀모형이 편향될 수 있다.</p>
        </blockquote>
      </li>
    </ol>
  </li>
</ul>

<h2 id="r을-이용한-다중상관-분석">R을 이용한 다중상관 분석</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">albumSales.2</span><span class="o">&lt;-</span><span class="n">lm</span><span class="p">(</span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album2</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">albumSales.3</span><span class="o">&lt;-</span><span class="n">lm</span><span class="p">(</span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">airplay</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attract</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album2</span><span class="p">)</span><span class="w"> </span><span class="c1"># 다중 회귀</span><span class="w">
</span></code></pre></div></div>
<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">albumSales.2</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">lm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album2</span><span class="p">)</span><span class="w">

</span><span class="n">Residuals</span><span class="o">:</span><span class="w">
     </span><span class="n">Min</span><span class="w">       </span><span class="m">1</span><span class="n">Q</span><span class="w">   </span><span class="n">Median</span><span class="w">       </span><span class="m">3</span><span class="n">Q</span><span class="w">      </span><span class="n">Max</span><span class="w">
</span><span class="m">-152.949</span><span class="w">  </span><span class="m">-43.796</span><span class="w">   </span><span class="m">-0.393</span><span class="w">   </span><span class="m">37.040</span><span class="w">  </span><span class="m">211.866</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
             </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span><span class="w">    
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="m">1.341e+02</span><span class="w">  </span><span class="m">7.537e+00</span><span class="w">  </span><span class="m">17.799</span><span class="w">   </span><span class="o">&lt;</span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="n">adverts</span><span class="w">     </span><span class="m">9.612e-02</span><span class="w">  </span><span class="m">9.632e-03</span><span class="w">   </span><span class="m">9.979</span><span class="w">   </span><span class="o">&lt;</span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="n">Residual</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="w"> </span><span class="m">65.99</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">Multiple</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.3346</span><span class="p">,</span><span class="w">	</span><span class="n">Adjusted</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.3313</span><span class="w">
</span><span class="nb">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span><span class="w"> </span><span class="m">99.59</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="n">DF</span><span class="p">,</span><span class="w">  </span><span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2.2e-16</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>R = 0.3346 : 광고비가 음반 판매량 변동의 33.5%를 설명<br />
\(R^2 = 0.5784\)</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">lm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">airplay</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attract</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album2</span><span class="p">)</span><span class="w">

</span><span class="n">Residuals</span><span class="o">:</span><span class="w">
     </span><span class="n">Min</span><span class="w">       </span><span class="m">1</span><span class="n">Q</span><span class="w">   </span><span class="n">Median</span><span class="w">       </span><span class="m">3</span><span class="n">Q</span><span class="w">      </span><span class="n">Max</span><span class="w">
</span><span class="m">-121.324</span><span class="w">  </span><span class="m">-28.336</span><span class="w">   </span><span class="m">-0.451</span><span class="w">   </span><span class="m">28.967</span><span class="w">  </span><span class="m">144.132</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
              </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span><span class="w">    
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="m">-26.612958</span><span class="w">  </span><span class="m">17.350001</span><span class="w">  </span><span class="m">-1.534</span><span class="w">    </span><span class="m">0.127</span><span class="w">    
</span><span class="n">adverts</span><span class="w">       </span><span class="m">0.084885</span><span class="w">   </span><span class="m">0.006923</span><span class="w">  </span><span class="m">12.261</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="n">airplay</span><span class="w">       </span><span class="m">3.367425</span><span class="w">   </span><span class="m">0.277771</span><span class="w">  </span><span class="m">12.123</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="n">attract</span><span class="w">      </span><span class="m">11.086335</span><span class="w">   </span><span class="m">2.437849</span><span class="w">   </span><span class="m">4.548</span><span class="w"> </span><span class="m">9.49e-06</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="n">Residual</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="w"> </span><span class="m">47.09</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">196</span><span class="w"> </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
</span><span class="n">Multiple</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.6647</span><span class="p">,</span><span class="w">	</span><span class="n">Adjusted</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.6595</span><span class="w">
</span><span class="nb">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span><span class="w"> </span><span class="m">129.5</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="m">196</span><span class="w"> </span><span class="n">DF</span><span class="p">,</span><span class="w">  </span><span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2.2e-16</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>R = 0.6647 : 예측변수들이 음반 판매량 변동의 66.5%를 설명<br />
따라서 방송 횟수와 매력은 또 다른 33%(= 66.5% - 33.5%)에 해당<br />
판매량 = -26.61 + (0.08 * 광고비) + (3.38 * 방송홧수) + (11.09 * 매력)<br />
Pr(&gt;|t|) &lt; 0.05 보다 작으면 해당 예측변수는 모형에 유의한 수준으로 기여한다고 할 수 있다. 그리고 t값이 클수록 예측변수의 기여도가 커진다.</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">lm.beta</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 표준화된 벡터를 구하는 공식</span><span class="w">
  </span><span class="n">adverts</span><span class="w">   </span><span class="n">airplay</span><span class="w">   </span><span class="n">attract</span><span class="w">
</span><span class="m">0.5108462</span><span class="w"> </span><span class="m">0.5119881</span><span class="w"> </span><span class="m">0.1916834</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>이 추정값들은 예측변수의 표준편차가 1 단위 변할 때의 결과변수의 표준편차의 변화량이다.</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">confint</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 각 추정값의 신뢰구간을 구하는 함수</span><span class="w">
                   </span><span class="m">2.5</span><span class="w"> </span><span class="o">%      97.5 %</span><span class="w">
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="m">-60.82960967</span><span class="w">  </span><span class="m">7.60369295</span><span class="w">
</span><span class="n">adverts</span><span class="w">       </span><span class="m">0.07123166</span><span class="w">  </span><span class="m">0.09853799</span><span class="w">
</span><span class="n">airplay</span><span class="w">       </span><span class="m">2.81962186</span><span class="w">  </span><span class="m">3.91522848</span><span class="w">
</span><span class="n">attract</span><span class="w">       </span><span class="m">6.27855218</span><span class="w"> </span><span class="m">15.89411823</span><span class="w"> </span><span class="c1"># 조금 넓긴 한데 0을 포함하지 않고 있으며 다른 변수들보다 이 변수의 매개변수 추정값이 참값을 덜 대표한다.</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>좋은 모형의 신뢰구간은 그 범위가 좁다.<br />
b의 부호(양, 음)는 예측변수와 결과변수의 관계의 방향을 말해준다.<br />
따라서 아주 나쁜 모형의 신뢰구간은 0을 포함할 것이다.</p>
</blockquote>

<h3 id="모형의-비교">모형의 비교</h3>

<blockquote>
  <p>둘째 모형의 \(R^2\)이 첫 모형의 \(R^2\)보다 유의하게 더 큰지 판단해야 한다.<br />
\(R^2\)의 유의성은 F비로 검사할 수 있다.<br />
\(F = \frac{(N-k-1)R^2}{k(1-R^2)}\)</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">anova</span><span class="p">(</span><span class="n">albumSales.2</span><span class="p">,</span><span class="w"> </span><span class="n">albumSales.3</span><span class="p">)</span><span class="w">
</span><span class="n">Analysis</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Variance</span><span class="w"> </span><span class="n">Table</span><span class="w">

</span><span class="n">Model</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="w">
</span><span class="n">Model</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">airplay</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attract</span><span class="w">
  </span><span class="n">Res.Df</span><span class="w">    </span><span class="n">RSS</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">Sum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Sq</span><span class="w">      </span><span class="nb">F</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="nb">F</span><span class="p">)</span><span class="w">    
</span><span class="m">1</span><span class="w">    </span><span class="m">198</span><span class="w"> </span><span class="m">862264</span><span class="w">                                  
</span><span class="m">2</span><span class="w">    </span><span class="m">196</span><span class="w"> </span><span class="m">434575</span><span class="w">  </span><span class="m">2</span><span class="w">    </span><span class="m">427690</span><span class="w"> </span><span class="m">96.447</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2.2e-16</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>F 값 = 96.447, Pr(&gt;F) = 2.2e-16 &lt; 0.001 이므로 albumSales.2에 비해 albumSales.3가 자료에 유의한 수준으로 더 적합</p>
</blockquote>

<h3 id="이상치와-영향이-큰-사례들">이상치와 영향이 큰 사례들</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">residuals</span><span class="o">&lt;-</span><span class="n">resid</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 잔차</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">standardized.residuals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rstandard</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 표준화잔차</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">studentized.residuals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rstudent</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 스튜던트화 잔차</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">cooks.distance</span><span class="o">&lt;-</span><span class="n">cooks.distance</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 쿡의 거리</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">dfbeta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dfbeta</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># DFBeta</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">dffit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dffits</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># DFFit</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">leverage</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hatvalues</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># hat-value</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">covariance.ratios</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">covratio</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 공분산비</span><span class="w">

</span><span class="c1"># 보통의 표본에서는 사례의 95%는 표준화잔차가 약 +-2% 이내라고 기대한다.</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">large.residual</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">standardized.residuals</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">standardized.residuals</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">-2</span><span class="w"> </span><span class="c1"># 각 사례에 잔차가 -2보다 작거나 +2보다 큰 값 찾기</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">album2</span><span class="o">$</span><span class="n">large.residual</span><span class="p">)</span><span class="w"> </span><span class="c1"># 12</span><span class="w">

</span><span class="c1"># 공분산비에 대해서 기준 적용</span><span class="w">
</span><span class="c1"># CVR_i &gt; 1 + [3(k+1)/n] = 1 + [3(3+1)/200] = 1.06</span><span class="w">
</span><span class="c1"># CVR_i &lt; 1 - [3(k+1)/n] = 1 - [3(3+1)/200] = 0.94</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">out.cvr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">covariance.ratios</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1.06</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">album2</span><span class="o">$</span><span class="n">covariance.ratios</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0.94</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">album2</span><span class="o">$</span><span class="n">out.cvr</span><span class="p">)</span><span class="w"> </span><span class="c1"># 21</span><span class="w">
</span></code></pre></div></div>

<h3 id="독립성-가정의-평가">독립성 가정의 평가</h3>

<ul>
  <li>durbinWatsonTest()
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">durbinWatsonTest</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w"> </span><span class="c1"># == dwt(albumSales.3)</span><span class="w">
 </span><span class="n">lag</span><span class="w"> </span><span class="n">Autocorrelation</span><span class="w"> </span><span class="n">D</span><span class="o">-</span><span class="n">W</span><span class="w"> </span><span class="n">Statistic</span><span class="w"> </span><span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="w">
 </span><span class="m">1</span><span class="w">       </span><span class="m">0.0026951</span><span class="w">      </span><span class="m">1.949819</span><span class="w">   </span><span class="m">0.722</span><span class="w">
 </span><span class="n">Alternative</span><span class="w"> </span><span class="n">hypothesis</span><span class="o">:</span><span class="w"> </span><span class="n">rho</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>검정 통계량이 1보다 작거나 3보다 크면 주의할 필요가 있다는 것[이 값은 2에 가까울수록 좋다, 여기서는 1.95]<br />
여기서 p &gt; 0.05 이므로, 이 검정통계량은 전혀 유의하지 않다.</p>
</blockquote>

<h3 id="다중공선성-부재-가정의-평가">다중공선성 부재 가정의 평가</h3>

<ul>
  <li>VIF # 만일 VIF 값이 10보다 크면 문제의 여지가 있다.
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">vif</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w">
 </span><span class="n">adverts</span><span class="w">  </span><span class="n">airplay</span><span class="w">  </span><span class="n">attract</span><span class="w">
</span><span class="m">1.014593</span><span class="w"> </span><span class="m">1.042504</span><span class="w"> </span><span class="m">1.038455</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>허용 통계량 = 1/VIF # 허용 통계량이 0.2보다 작으면 모형에 뭔가 문제가 있을 가능성이 있다. 0.1보다 작으면 모형에 심각한 문제가 있는 것
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="n">vif</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w">
</span><span class="n">adverts</span><span class="w">   </span><span class="n">airplay</span><span class="w">   </span><span class="n">attract</span><span class="w">
</span><span class="m">0.9856172</span><span class="w"> </span><span class="m">0.9592287</span><span class="w"> </span><span class="m">0.9629695</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>평균 VIF # 평균 VIF값이 1보다 확연하게 크면 회귀모형이 편향되어있을 수 있다.
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">vif</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">))</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">1.03185</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>결론 : 우리의 모형에 다중공선성이 존재하지는 않는다고 결론을 내려도 안전</p>
</blockquote>

<h3 id="잔차에-관한-여러-가정의-검정">잔차에 관한 여러 가정의 검정</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">albumSales.3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div style="display: flex; justify-content: space-between;">
  <img src="/assets/images/Book/Discovering_Statistics_Using_R/Rplot_029.png" alt="image_01" style="width: 49%; margin-right: 1vw;" />
  <img src="/assets/images/Book/Discovering_Statistics_Using_R/Rplot_030.png" alt="image_02" style="width: 49%; margin-right: 1vw;" />
</div>
<div style="display: flex; justify-content: space-between;">
  <img src="/assets/images/Book/Discovering_Statistics_Using_R/Rplot_031.png" alt="image_03" style="width: 49%; margin-right: 1vw;" />
  <img src="/assets/images/Book/Discovering_Statistics_Using_R/Rplot_032.png" alt="image_03" style="width: 49%; margin-right: 1vw;" />
</div>

<h2 id="가정이-깨졌다면---강건한-회귀--부트스트래핑">가정이 깨졌다면? -&gt; 강건한 회귀 : 부트스트래핑</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">bootReg</span><span class="o">&lt;-</span><span class="k">function</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w">
</span><span class="o">+</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="o">+</span><span class="w">     </span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span><span class="w">
</span><span class="o">+</span><span class="w">     </span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w">
</span><span class="o">+</span><span class="w">     </span><span class="nf">return</span><span class="p">(</span><span class="n">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span><span class="w"> </span><span class="c1"># 주어진 모형의 절편과 예측변수들의 기울기 계수들을 출력</span><span class="w">
</span><span class="o">+</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">bootResults</span><span class="o">&lt;-</span><span class="n">boot</span><span class="p">(</span><span class="n">statistic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bootReg</span><span class="p">,</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sales</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">adverts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">airplay</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attract</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">album2</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w"> </span><span class="c1"># 부트스트랩 표본 얻기</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">boot.ci</span><span class="p">(</span><span class="n">bootResults</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bca"</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># bca : 신뢰구간의 종류, index : 통계량의 위치(1 = 절편)</span><span class="w">
</span><span class="n">BOOTSTRAP</span><span class="w"> </span><span class="n">CONFIDENCE</span><span class="w"> </span><span class="n">INTERVAL</span><span class="w"> </span><span class="n">CALCULATIONS</span><span class="w">
</span><span class="n">Based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="n">bootstrap</span><span class="w"> </span><span class="n">replicates</span><span class="w">

</span><span class="n">CALL</span><span class="w"> </span><span class="o">:</span><span class="w">
</span><span class="n">boot.ci</span><span class="p">(</span><span class="n">boot.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bootResults</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bca"</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="n">Intervals</span><span class="w"> </span><span class="o">:</span><span class="w">
</span><span class="n">Level</span><span class="w">       </span><span class="n">BCa</span><span class="w">          
</span><span class="m">95</span><span class="o">%</span><span class="w">   </span><span class="p">(</span><span class="m">-55.26</span><span class="p">,</span><span class="w">   </span><span class="m">9.02</span><span class="w"> </span><span class="p">)</span><span class="w">  
</span><span class="n">Calculations</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">Intervals</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Original</span><span class="w"> </span><span class="n">Scale</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>절편의 신뢰구간 : -55.26 ~ 9.02<br />
이러한 신뢰구간은 앞에서 대입(plug-in) 접근방식으로 얻은 신뢰구간과 비교해보자(여기서는 상당히 비슷하다)</p>
</blockquote>

<h2 id="다중회귀의-보고">다중회귀의 보고</h2>

<table>
  <tbody>
    <tr>
      <td>—</td>
      <td>\(R^2\)</td>
      <td>B</td>
      <td>SE B</td>
      <td>\(\beta\)</td>
      <td>p</td>
    </tr>
    <tr>
      <td>단계 1</td>
      <td>0.34</td>
      <td>—</td>
      <td>—</td>
      <td>—</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>상수</td>
      <td>—</td>
      <td>134.14</td>
      <td>7.54</td>
      <td>—</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>광고비</td>
      <td>—</td>
      <td>0.10</td>
      <td>0.01</td>
      <td>0.58*</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>단계 2</td>
      <td>0.33</td>
      <td>—</td>
      <td>—</td>
      <td>—</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>상수</td>
      <td>—</td>
      <td>-26.61</td>
      <td>17.35</td>
      <td>—</td>
      <td>.127</td>
    </tr>
    <tr>
      <td>광고비</td>
      <td>—</td>
      <td>0.09</td>
      <td>0.01</td>
      <td>0.51*</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>BBC 라디오 1 방송 횟수</td>
      <td>—</td>
      <td>3.37</td>
      <td>0.28</td>
      <td>0.51*</td>
      <td>&lt;.001</td>
    </tr>
    <tr>
      <td>밴드 매력</td>
      <td>—</td>
      <td>11.09</td>
      <td>2.44</td>
      <td>0.19*</td>
      <td>&lt;.001</td>
    </tr>
  </tbody>
</table>

<h2 id="범주형-예측변수와-다중회귀">범주형 예측변수와 다중회귀</h2>

<blockquote>
  <p>범주형 변수를 예측변수로 사용하려고 할 때 문제는, 사용하려는 범주형 변수의 범주의 개수가 두 개를 넘는다.<br />
Ex. 종교 : 이슬람교, 유대교, 가톨릭, …<br />
해결책 -&gt; 가변수(dummy variable)사용  [ 부호화하고자 하는 그룹(집단)의 개수에서 1을 뺀 것만큼 변수를 생성]</p>
</blockquote>

<h3 id="가변수">가변수</h3>

<ul>
  <li>가변수 과정
    <ol>
      <li>부호화하려는 그룹의 수에서 1을 뺀다</li>
      <li>단계 1에서 구한 개수만큼 새 변수를 만든다. [ = 이들이 가변수 ]</li>
      <li>그룹 중 하나를 기저(baseline) 그룹으로 선택한다.</li>
      <li>모든 가변수에 대해, 기저 그룹에 그랍 값 0을 배정한다.</li>
      <li>첫 가변수에 대해, 기저 그룹과 비교할 첫 그룹에 값 1을 배정한다.</li>
      <li>둘째 가변수에 대해, 기저 그룹과 비교할 둘째 그룹에 값 1을 배정한다.</li>
      <li>나머지 반복</li>
      <li>이 가변수들을 모두 회귀모형에 추가</li>
    </ol>
  </li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">gfr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
   </span><span class="n">ticknumb</span><span class="w">                  </span><span class="n">music</span><span class="w"> </span><span class="n">day1</span><span class="w"> </span><span class="n">day2</span><span class="w"> </span><span class="n">day3</span><span class="w"> </span><span class="n">change</span><span class="w">
</span><span class="m">1</span><span class="w">      </span><span class="m">2111</span><span class="w">               </span><span class="n">Metaller</span><span class="w"> </span><span class="m">2.65</span><span class="w"> </span><span class="m">1.35</span><span class="w"> </span><span class="m">1.61</span><span class="w">  </span><span class="m">-1.04</span><span class="w">
</span><span class="m">2</span><span class="w">      </span><span class="m">2229</span><span class="w">                 </span><span class="n">Crusty</span><span class="w"> </span><span class="m">0.97</span><span class="w"> </span><span class="m">1.41</span><span class="w"> </span><span class="m">0.29</span><span class="w">  </span><span class="m">-0.68</span><span class="w">
</span><span class="m">3</span><span class="w">      </span><span class="m">2338</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w"> </span><span class="m">0.84</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">4</span><span class="w">      </span><span class="m">2384</span><span class="w">                 </span><span class="n">Crusty</span><span class="w"> </span><span class="m">3.03</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">5</span><span class="w">      </span><span class="m">2401</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w"> </span><span class="m">0.88</span><span class="w"> </span><span class="m">0.08</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">6</span><span class="w">      </span><span class="m">2405</span><span class="w">                 </span><span class="n">Crusty</span><span class="w"> </span><span class="m">0.85</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">7</span><span class="w">      </span><span class="m">2467</span><span class="w">              </span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w"> </span><span class="m">1.56</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">8</span><span class="w">      </span><span class="m">2478</span><span class="w">              </span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w"> </span><span class="m">3.02</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">9</span><span class="w">      </span><span class="m">2490</span><span class="w">                 </span><span class="n">Crusty</span><span class="w"> </span><span class="m">2.29</span><span class="w">   </span><span class="kc">NA</span><span class="w">   </span><span class="kc">NA</span><span class="w">     </span><span class="kc">NA</span><span class="w">
</span><span class="m">10</span><span class="w">     </span><span class="m">2504</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w"> </span><span class="m">1.11</span><span class="w"> </span><span class="m">0.44</span><span class="w"> </span><span class="m">0.55</span><span class="w">  </span><span class="m">-0.56</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>music 컬럼이 문자열</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">gfr</span><span class="o">$</span><span class="n">music</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">gfr</span><span class="o">$</span><span class="n">msuic</span><span class="p">)</span><span class="w"> </span><span class="c1"># 요인으로 변경</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">contrasts</span><span class="p">(</span><span class="n">gfr</span><span class="o">$</span><span class="n">music</span><span class="p">)</span><span class="o">&lt;-</span><span class="n">contr.treatment</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="c1"># contrasts(gfr$music) : gfr 데이터프레임의 변수 music 에 대한 대비를 설정</span><span class="w">
</span><span class="c1"># contr.treatment(그룹 수, base = 기저 그룹의 번호) : 모든 그룹을 하나의 기저 조건과 비교한 결과에 기초해서 대비를 계산</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">gfr</span><span class="o">$</span><span class="n">music</span><span class="w">
</span><span class="nf">attr</span><span class="p">(,</span><span class="s2">"contrasts"</span><span class="p">)</span><span class="w">
                       </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w">
</span><span class="n">Crusty</span><span class="w">                 </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w">              </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">Metaller</span><span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">Levels</span><span class="o">:</span><span class="w"> </span><span class="n">Crusty</span><span class="w"> </span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w"> </span><span class="n">Metaller</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w">

</span><span class="c1"># 위 과정에 변수 이름 설정하는 방법</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">crusty_v_NMA</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">indie_v_NMA</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">metal_v_NMA</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">contrasts</span><span class="p">(</span><span class="n">gfr</span><span class="o">$</span><span class="n">music</span><span class="p">)</span><span class="o">&lt;-</span><span class="n">cbind</span><span class="p">(</span><span class="n">crusty_v_NMA</span><span class="p">,</span><span class="w"> </span><span class="n">indie_v_NMA</span><span class="p">,</span><span class="w"> </span><span class="n">metal_v_NMA</span><span class="p">)</span><span class="w">
</span><span class="nf">attr</span><span class="p">(,</span><span class="s2">"contrasts"</span><span class="p">)</span><span class="w">
                       </span><span class="n">crusty_v_NMA</span><span class="w"> </span><span class="n">indie_v_NMA</span><span class="w"> </span><span class="n">metal_v_NMA</span><span class="w">
</span><span class="n">Crusty</span><span class="w">                            </span><span class="m">1</span><span class="w">           </span><span class="m">0</span><span class="w">           </span><span class="m">0</span><span class="w">
</span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w">                         </span><span class="m">0</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">0</span><span class="w">
</span><span class="n">Metaller</span><span class="w">                          </span><span class="m">0</span><span class="w">           </span><span class="m">0</span><span class="w">           </span><span class="m">1</span><span class="w">
</span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w">            </span><span class="m">0</span><span class="w">           </span><span class="m">0</span><span class="w">           </span><span class="m">0</span><span class="w">
</span><span class="n">Levels</span><span class="o">:</span><span class="w"> </span><span class="n">Crusty</span><span class="w"> </span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w"> </span><span class="n">Metaller</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w">
</span></code></pre></div></div>

<h3 id="가변수를-이용한-회귀분석">가변수를 이용한 회귀분석</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">glastonburyModel</span><span class="o">&lt;-</span><span class="n">lm</span><span class="p">(</span><span class="n">change</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">music</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gfr</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">glastonburyModel</span><span class="p">)</span><span class="w">

</span><span class="n">Call</span><span class="o">:</span><span class="w">
</span><span class="n">lm</span><span class="p">(</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">music</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gfr</span><span class="p">)</span><span class="w">

</span><span class="n">Residuals</span><span class="o">:</span><span class="w">
     </span><span class="n">Min</span><span class="w">       </span><span class="m">1</span><span class="n">Q</span><span class="w">   </span><span class="n">Median</span><span class="w">       </span><span class="m">3</span><span class="n">Q</span><span class="w">      </span><span class="n">Max</span><span class="w">
</span><span class="m">-1.82569</span><span class="w"> </span><span class="m">-0.50489</span><span class="w">  </span><span class="m">0.05593</span><span class="w">  </span><span class="m">0.42430</span><span class="w">  </span><span class="m">1.59431</span><span class="w">

</span><span class="n">Coefficients</span><span class="o">:</span><span class="w">
                  </span><span class="n">Estimate</span><span class="w"> </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span><span class="w">    
</span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">       </span><span class="m">-0.55431</span><span class="w">    </span><span class="m">0.09036</span><span class="w">  </span><span class="m">-6.134</span><span class="w"> </span><span class="m">1.15e-08</span><span class="w"> </span><span class="o">***</span><span class="w">
</span><span class="n">musiccrusty_v_NMA</span><span class="w"> </span><span class="m">-0.41152</span><span class="w">    </span><span class="m">0.16703</span><span class="w">  </span><span class="m">-2.464</span><span class="w">   </span><span class="m">0.0152</span><span class="w"> </span><span class="o">*</span><span class="w">  
</span><span class="n">musicindie_v_NMA</span><span class="w">  </span><span class="m">-0.40998</span><span class="w">    </span><span class="m">0.20492</span><span class="w">  </span><span class="m">-2.001</span><span class="w">   </span><span class="m">0.0477</span><span class="w"> </span><span class="o">*</span><span class="w">  
</span><span class="n">musicmetal_v_NMA</span><span class="w">   </span><span class="m">0.02838</span><span class="w">    </span><span class="m">0.16033</span><span class="w">   </span><span class="m">0.177</span><span class="w">   </span><span class="m">0.8598</span><span class="w">    
</span><span class="o">---</span><span class="w">
</span><span class="n">Signif.</span><span class="w"> </span><span class="n">codes</span><span class="o">:</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="err">‘</span><span class="n">.</span><span class="err">’</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="n">Residual</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="w"> </span><span class="m">0.6882</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">119</span><span class="w"> </span><span class="n">degrees</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">freedom</span><span class="w">
  </span><span class="p">(</span><span class="n">결측으로</span><span class="w"> </span><span class="n">인하여</span><span class="w"> </span><span class="m">687</span><span class="n">개의</span><span class="w"> </span><span class="n">관측치가</span><span class="w"> </span><span class="n">삭제되었습니다.</span><span class="p">)</span><span class="w">
</span><span class="n">Multiple</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.07617</span><span class="p">,</span><span class="w">	</span><span class="n">Adjusted</span><span class="w"> </span><span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="o">:</span><span class="w">  </span><span class="m">0.05288</span><span class="w">
</span><span class="nb">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span><span class="w">  </span><span class="m">3.27</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="m">119</span><span class="w"> </span><span class="n">DF</span><span class="p">,</span><span class="w">  </span><span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="m">0.02369</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>\(R^2\) = 7.6% -&gt; 위생 점수 변화량의 변동의 7.6%는 참가자의 음악 취향으로 설명된다.<br />
F 통계량에 따르면, 이 모형은 모형이 없을 때보다 위생 점수의 변화를 유의한 수준으로 더 잘 예측한다.</p>
</blockquote>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">tapply</span><span class="p">(</span><span class="n">gfr</span><span class="o">$</span><span class="n">change</span><span class="p">,</span><span class="w"> </span><span class="n">gfr</span><span class="o">$</span><span class="n">music</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
                </span><span class="n">Crusty</span><span class="w">              </span><span class="n">Indie</span><span class="w"> </span><span class="n">Kid</span><span class="w">               </span><span class="n">Metaller</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">Musical</span><span class="w"> </span><span class="n">Affiliation</span><span class="w">
                </span><span class="m">-0.966</span><span class="w">                 </span><span class="m">-0.964</span><span class="w">                 </span><span class="m">-0.526</span><span class="w">                 </span><span class="m">-0.554</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>크러스티 그룹과 무취향 그룹 평균의 차이는 -0.966 - (-0.554) = -0.412 이다.<br />
따라서, 크러스티 그룹의 위생 점수 변화가 무취향 그룹의 위생 점수 변화보다 크다.</p>
</blockquote>

  </div>
  <div class="md-index">
    <h2>목차</h2>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#discovering-statistics-using-r---007---2024년12월06일">Discovering Statistics Using R - 007 - 2024년12월06일</a></li>
<li class="toc-entry toc-h1"><a href="#회귀">회귀</a>
<ul>
<li class="toc-entry toc-h2"><a href="#r을-이용한-회귀분석">R을 이용한 회귀분석</a>
<ul>
<li class="toc-entry toc-h3"><a href="#단순-회귀">단순 회귀</a></li>
<li class="toc-entry toc-h3"><a href="#다중회귀">다중회귀</a>
<ul>
<li class="toc-entry toc-h4"><a href="#r2-aic">\(R^2, AIC\)</a></li>
<li class="toc-entry toc-h4"><a href="#예측변수-선택-방법">예측변수 선택 방법</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#회귀모형의-정확도-평가">회귀모형의 정확도 평가</a>
<ul>
<li class="toc-entry toc-h4"><a href="#이상치와-잔차">이상치와 잔차</a></li>
<li class="toc-entry toc-h4"><a href="#영향력이-큰-사례들">영향력이 큰 사례들</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#회귀모형의-평가--일반화">회귀모형의 평가 : 일반화</a>
<ul>
<li class="toc-entry toc-h4"><a href="#가정-검정">가정 검정</a></li>
<li class="toc-entry toc-h4"><a href="#모형의-교차-타당성-검증">모형의 교차 타당성 검증</a></li>
<li class="toc-entry toc-h4"><a href="#표본의-개수">표본의 개수</a></li>
<li class="toc-entry toc-h4"><a href="#공선성">공선성</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#r을-이용한-다중상관-분석">R을 이용한 다중상관 분석</a>
<ul>
<li class="toc-entry toc-h3"><a href="#모형의-비교">모형의 비교</a></li>
<li class="toc-entry toc-h3"><a href="#이상치와-영향이-큰-사례들">이상치와 영향이 큰 사례들</a></li>
<li class="toc-entry toc-h3"><a href="#독립성-가정의-평가">독립성 가정의 평가</a></li>
<li class="toc-entry toc-h3"><a href="#다중공선성-부재-가정의-평가">다중공선성 부재 가정의 평가</a></li>
<li class="toc-entry toc-h3"><a href="#잔차에-관한-여러-가정의-검정">잔차에 관한 여러 가정의 검정</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#가정이-깨졌다면---강건한-회귀--부트스트래핑">가정이 깨졌다면? -&gt; 강건한 회귀 : 부트스트래핑</a></li>
<li class="toc-entry toc-h2"><a href="#다중회귀의-보고">다중회귀의 보고</a></li>
<li class="toc-entry toc-h2"><a href="#범주형-예측변수와-다중회귀">범주형 예측변수와 다중회귀</a>
<ul>
<li class="toc-entry toc-h3"><a href="#가변수">가변수</a></li>
<li class="toc-entry toc-h3"><a href="#가변수를-이용한-회귀분석">가변수를 이용한 회귀분석</a></li>
</ul>
</li>
</ul>
</li>
</ul>
    <hr>
    <h2>관련 POST</h2>
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/21/Discovering-Statistics-Using-R-010.html">Discovering Statistics Using R - 010 [ 2024년12월21일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/12/Discovering-Statistics-Using-R-009.html">Discovering Statistics Using R - 009 [ 2024년12월12일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/10/Discovering-Statistics-Using-R-008.html">Discovering Statistics Using R - 008 [ 2024년12월10일 ]</a>
          </p>
        
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/12/06/Discovering-Statistics-Using-R-007.html">Discovering Statistics Using R - 007 [ 2024년12월06일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/05/Discovering-Statistics-Using-R-006.html">Discovering Statistics Using R - 006 [ 2024년12월05일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/04/Discovering-Statistics-Using-R-005.html">Discovering Statistics Using R - 005 [ 2024년12월04일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/12/03/Discovering-Statistics-Using-R-004.html">Discovering Statistics Using R - 004 [ 2024년12월03일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/30/Discovering-Statistics-Using-R-003.html">Discovering Statistics Using R - 003 [ 2024년11월30일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/29/Discovering-Statistics-Using-R-002.html">Discovering Statistics Using R - 002 [ 2024년11월29일 ]</a>
          </p>
        
      
        
      
    
      
        
          <p>
            <a href="/2024/11/28/Discovering-Statistics-Using-R-001.html">Discovering Statistics Using R - 001 [ 2024년11월28일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
  </div>
</div>

<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 56,
  backgroundColor: 'rgb(135, 206, 250)',
  textColor: '#fff'
})</script>

<!-- Latex -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

			  </div>
			</div>
			<div class="footer">
  <p>Email : qkrdlstn9701@naver.com</p>
  <a href="https://github.com/insu97">SITE : GITHUB_PAGE</a>
</div>

  </body>
</html>
<script src="/assets/js/music-controls.js" defer></script>
