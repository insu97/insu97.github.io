<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>HackerRank - SQL - Advanced Select</title>
		<link rel="stylesheet" href="/assets/css/default.css">
		<link rel="stylesheet" href="/assets/css/code.css">
		<link rel="icon" type="image/png" href="/assets/favicon/favicon.ico">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		<!-- head.html 또는 기본 레이아웃 파일에 추가 -->
		<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css' rel='stylesheet' />
		<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js'></script>
	</head>
  <body>
      <div class = "header">
  <div class = "blog_image">
    <img src="/assets/images/coffee.png" title="coffee">
  </div>
  <div class = "main_text">
    <h1><a href='/'>In수</a></h1>
  </div>

  <!-- 원하는 위치에 시계를 삽입 -->
  <div id="clock"></div>
</div>

<script>
  function startTime() {
    const today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    setTimeout(startTime, 1000);
  }

  function checkTime(i) {
    if (i < 10) { i = "0" + i };  // 10보다 작으면 앞에 0을 추가
    return i;
  }

  // 페이지 로드 시 시계 시작
  document.addEventListener('DOMContentLoaded', startTime);
</script>

			<div class="container">
			  <div class="navigation">
					<ul>
					  
					    <li><a href="/index.html">HOME</a></li>
					  
					    <li><a href="/posts/index.html">POSTS</a></li>
					  
					    <li><a href="/tags.html">TAGS</a></li>
					  
					    <li><a href="/study.html">STUDY</a></li>
					  
					    <li><a href="/project.html">PROJECT</a></li>
					  
					    <li><a href="/paper.html">PAPER</a></li>
					  
					</ul>
			  </div>
			  <div class="main">
					<div class="markdown-body">
  <div class="md-content">
    <h1 id="hackerrank---sql---advanced-select---2024년10월04일">HackerRank - SQL - Advanced Select - 2024년10월04일</h1>

<!-- - tag : SQL MySQL  -->
<ul>
  <li>tag : <a href="/tags/tag_SQL.html" class="btn btn-default navbar-btn cursorNorm" role="button">SQL</a>
|
<a href="/tags/tag_MySQL.html" class="btn btn-default navbar-btn cursorNorm" role="button">MySQL</a>
|</li>
</ul>

<hr />

<blockquote>
  <p>SITE : <a href="https://www.hackerrank.com/">HackerRank</a></p>
</blockquote>

<h1 id="001---case">001 - CASE</h1>

<ul>
  <li>문제</li>
</ul>

<blockquote>
  <p>Write a query identifying the type of each record in the TRIANGLES table using its three side lengths.<br />
Output one of the following statements for each record in the table:</p>
  <ul>
    <li>Equilateral: It’s a triangle with  sides of equal length.</li>
    <li>Isosceles: It’s a triangle with  sides of equal length.</li>
    <li>Scalene: It’s a triangle with  sides of differing lengths.</li>
    <li>Not A Triangle: The given values of A, B, and C don’t form a triangle.</li>
  </ul>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">&lt;=</span> <span class="k">C</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="k">C</span> <span class="o">&lt;=</span> <span class="n">B</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">B</span> <span class="o">+</span> <span class="k">C</span> <span class="o">&lt;=</span> <span class="n">A</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">'Not A Triangle'</span>
            <span class="k">WHEN</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="k">C</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">'Equilateral'</span>
            <span class="k">WHEN</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">B</span> <span class="o">=</span> <span class="k">C</span><span class="p">)</span><span class="k">or</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="k">C</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">'Isosceles'</span>
            <span class="k">WHEN</span> <span class="p">(</span><span class="n">A</span> <span class="o">!=</span> <span class="n">B</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">B</span> <span class="o">!=</span> <span class="k">C</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">A</span> <span class="o">!=</span> <span class="k">C</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">'Scalene'</span>
        <span class="k">END</span>
<span class="k">FROM</span> <span class="n">TRIANGLES</span>
</code></pre></div></div>

<h1 id="002---concat">002 - CONCAT</h1>

<ul>
  <li>문제</li>
</ul>

<blockquote>
  <p>Generate the following two result sets:</p>
  <ol>
    <li>Query an alphabetically ordered list of all names in OCCUPATIONS, immediately followed by the first letter of each profession as a parenthetical<br />
(i.e.: enclosed in parentheses). For example:AnActorName(A), ADoctorName(D), AProfessorName(P), and ASingerName(S).</li>
    <li>Query the number of ocurrences of each occupation in OCCUPATIONS. Sort the occurrences in ascending order, and output them in the following format:<br />
There are a total of [occupation_count] [occupation]s.<br />
where [occupation_count] is the number of occurrences of an occupation in OCCUPATIONS and [occupation] is the lowercase occupation name.<br />
If more than one Occupation has the same [occupation_count], they should be ordered alphabetically.</li>
  </ol>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">NAME</span><span class="p">,</span> <span class="s1">'('</span><span class="p">,</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">Occupation</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">')'</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">OCCUPATIONS</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">NAME</span> <span class="k">ASC</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="s1">'There are a total of '</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">Occupation</span><span class="p">),</span> <span class="s1">' '</span><span class="p">,</span> <span class="k">lower</span><span class="p">(</span><span class="n">Occupation</span><span class="p">),</span> <span class="s1">'s.'</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">OCCUPATIONS</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">Occupation</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">Occupation</span><span class="p">)</span> <span class="k">ASC</span><span class="p">,</span> <span class="n">Occupation</span> <span class="k">ASC</span>
</code></pre></div></div>

<h1 id="003---row_number">003 - ROW_NUMBER()</h1>

<ul>
  <li>문제</li>
</ul>

<blockquote>
  <p>Pivot the Occupation column in OCCUPATIONS so that each Name is sorted alphabetically and displayed underneath its corresponding Occupation.<br />
The output column headers should be Doctor, Professor, Singer, and Actor, respectively.</p>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- MAX : GROUP BY 를 사용하기 위한 트릭  </span>
<span class="k">SELECT</span>
        <span class="k">MAX</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">Occupation</span> <span class="o">=</span> <span class="s1">'Doctor'</span> <span class="k">THEN</span> <span class="n">NAME</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="s1">'Doctor'</span><span class="p">,</span>
        <span class="k">MAX</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">Occupation</span> <span class="o">=</span> <span class="s1">'Professor'</span> <span class="k">THEN</span> <span class="n">NAME</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="s1">'Professor'</span><span class="p">,</span>
        <span class="k">MAX</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">Occupation</span> <span class="o">=</span> <span class="s1">'Singer'</span> <span class="k">THEN</span> <span class="n">NAME</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="s1">'Singer'</span><span class="p">,</span>
        <span class="k">MAX</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">Occupation</span> <span class="o">=</span> <span class="s1">'Actor'</span> <span class="k">THEN</span> <span class="n">NAME</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="s1">'Actor'</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span><span class="p">,</span>
    <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">PARTITION</span> <span class="k">BY</span> <span class="n">OCCUPATION</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">NAME</span><span class="p">)</span> <span class="k">AS</span> <span class="n">RN</span>
<span class="k">FROM</span> <span class="n">OCCUPATIONS</span><span class="p">)</span> <span class="k">TEMP</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">RN</span>
</code></pre></div></div>

<h1 id="004---in">004 - IN</h1>

<ul>
  <li>문제</li>
</ul>

<blockquote>
  <p>You are given a table, BST, containing two columns: N and P, where N represents the value of a node in Binary Tree, and P is the parent of N.</p>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">N</span><span class="p">,</span>
        <span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="n">P</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s1">'Root'</span>
            <span class="k">WHEN</span> <span class="n">N</span> <span class="k">in</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">P</span> <span class="k">FROM</span> <span class="n">BST</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">'Inner'</span>
            <span class="k">ELSE</span> <span class="s1">'Leaf'</span>
        <span class="k">END</span>
<span class="k">From</span> <span class="n">BST</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">N</span> <span class="k">ASC</span>
</code></pre></div></div>

<h1 id="005">005</h1>

<ul>
  <li>문제</li>
</ul>

<blockquote>
  <p>Given the table schemas below, write a query to print the company_code, founder name, total number of lead managers, total number of senior managers, <br />
total number of managers, and total number of employees. Order your output by ascending company_code.</p>
</blockquote>

<blockquote>
  <p>Note:</p>
  <ul>
    <li>The tables may contain duplicate records.</li>
    <li>The company_code is string, so the sorting should not be numeric. For example, if the company_codes are C_1, C_2, and C_10,</li>
    <li>then the ascending company_codes will be C_1, C_10, and C_2.</li>
  </ul>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">founder</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">l</span><span class="p">.</span><span class="n">lead_manager_code</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Lead_Manager</span> <span class="n">l</span> <span class="k">WHERE</span> <span class="n">l</span><span class="p">.</span><span class="n">company_code</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">),</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">s</span><span class="p">.</span><span class="n">senior_manager_code</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Senior_Manager</span> <span class="n">s</span> <span class="k">WHERE</span> <span class="n">s</span><span class="p">.</span><span class="n">company_code</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">),</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">m</span><span class="p">.</span><span class="n">manager_code</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Manager</span> <span class="n">m</span> <span class="k">WHERE</span> <span class="n">m</span><span class="p">.</span><span class="n">company_code</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">),</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_code</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="n">e</span> <span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">company_code</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">Company</span> <span class="k">c</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">c</span><span class="p">.</span><span class="n">company_code</span> <span class="k">ASC</span><span class="p">;</span>
</code></pre></div></div>

  </div>
  <div class="md-index">
    <h2>목차</h2>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#hackerrank---sql---advanced-select---2024년10월04일">HackerRank - SQL - Advanced Select - 2024년10월04일</a></li>
<li class="toc-entry toc-h1"><a href="#001---case">001 - CASE</a></li>
<li class="toc-entry toc-h1"><a href="#002---concat">002 - CONCAT</a></li>
<li class="toc-entry toc-h1"><a href="#003---row_number">003 - ROW_NUMBER()</a></li>
<li class="toc-entry toc-h1"><a href="#004---in">004 - IN</a></li>
<li class="toc-entry toc-h1"><a href="#005">005</a></li>
</ul>
    <hr>
    <h2>관련 POST</h2>
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
      
        
      
    
      
        
          <p>
            <a href="/2024/10/04/HackerRank_SQL_002.html">HackerRank - SQL - Advanced Select [ 2024년10월04일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/09/28/HackerRank_SQL_001.html">HackerRank - SQL - Basic Select [ 2024년09월28일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
        
      
        
      
    
      
        
      
        
      
        
      
    
      
        
      
        
      
    
  </div>
</div>

<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 56,
  backgroundColor: 'rgb(135, 206, 250)',
  textColor: '#fff'
})</script>

<!-- Latex -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

			  </div>
			</div>
			<div class="footer">
  <p>Email : qkrdlstn9701@naver.com</p>
  <a href="https://github.com/insu97">SITE : GITHUB_PAGE</a>
</div>

  </body>
</html>
