<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>데이터·AI를 활용한 물가 예측 경진대회 농산물 가격을 중심으로</title>
		<link rel="stylesheet" href="/assets/css/default.css">
		<link rel="stylesheet" href="/assets/css/code.css">
		<link rel="icon" type="image/png" href="/assets/favicon/favicon.ico">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>

		<!-- head.html 또는 기본 레이아웃 파일에 추가 -->
		<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.css' rel='stylesheet' />
		<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js'></script>
	</head>
  <body>
      <div class = "header">
  <div class = "blog_image">
    <img src="/assets/images/coffee.png" title="coffee">
  </div>
  <div class = "main_text">
    <h1><a href='/'>In수</a></h1>
  </div>

  <!-- 원하는 위치에 시계를 삽입 -->
  <div id="clock"></div>
</div>

<script>
  function startTime() {
    const today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    setTimeout(startTime, 1000);
  }

  function checkTime(i) {
    if (i < 10) { i = "0" + i };  // 10보다 작으면 앞에 0을 추가
    return i;
  }

  // 페이지 로드 시 시계 시작
  document.addEventListener('DOMContentLoaded', startTime);
</script>

			<div class="container">
			  <div class="navigation">
					<ul>
					  
					    <li><a href="/index.html">HOME</a></li>
					  
					    <li><a href="/posts/index.html">POSTS</a></li>
					  
					    <li><a href="/tags.html">TAGS</a></li>
					  
					    <li><a href="/study.html">STUDY</a></li>
					  
					    <li><a href="/project.html">PROJECT</a></li>
					  
					    <li><a href="/paper.html">PAPER</a></li>
					  
					</ul>
			  </div>
			  <div class="main">
					<div class="markdown-body">
  <div class="md-content">
    <h1 id="데이터ai를-활용한-물가-예측-경진대회-농산물-가격을-중심으로---2024년10월01일">데이터·AI를 활용한 물가 예측 경진대회 농산물 가격을 중심으로 - 2024년10월01일</h1>

<!-- - tag : Dacon Time-Series  -->
<ul>
  <li>tag : <a href="/tags/tag_Dacon.html" class="btn btn-default navbar-btn cursorNorm" role="button">Dacon</a>
|
<a href="/tags/tag_Time-Series.html" class="btn btn-default navbar-btn cursorNorm" role="button">Time-Series</a>
|</li>
</ul>

<hr />

<ul>
  <li>site : <a href="https://www.dacon.io/competitions/official/236381/overview/description">Dacon_site</a></li>
  <li>기간 : 2024-10-01 ~ 2024-10-14</li>
</ul>

<hr />

<h1 id="문제설명">문제설명</h1>

<ol>
  <li>train_data : 2018 ~ 2021년의 순 단위(10일)</li>
  <li>test_data : 추론 시점 T가 비식별화된 2022년의 순 단위의 데이터</li>
  <li>sub_data : 추론 시점 T 기준으로 T+1순, T+2순, T+3순의 평균가격을 예측하여 제출</li>
</ol>

<ul>
  <li>조건<br />
<img src="/assets/images/dacon/Dacon_002.png" alt="image" /></li>
</ul>

<h1 id="전처리">전처리</h1>

<h2 id="품목별로-전처리">품목별로 전처리</h2>

<h3 id="건고추">건고추</h3>

<ul>
  <li>건고추</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/raw_data/train/train.csv</span><span class="sh">"</span><span class="p">)</span>

<span class="n">train_건고추</span> <span class="o">=</span> <span class="n">train</span><span class="p">[(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">건고추</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">화건</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">30 kg</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span><span class="p">)]</span>

<span class="n">train_건고추</span> <span class="o">=</span> <span class="n">train_건고추</span><span class="p">[[</span><span class="sh">'</span><span class="s">평균가격(원)</span><span class="sh">'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_00</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">../data/raw_data/test/TEST_00.csv</span><span class="sh">"</span><span class="p">)</span>

<span class="n">test_00_건고추</span> <span class="o">=</span> <span class="n">test_00</span><span class="p">[(</span><span class="n">test_00</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">건고추</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test_00</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">화건</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test_00</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">30 kg</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test_00</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span><span class="p">)]</span>

<span class="n">test_00_건고추</span> <span class="o">=</span> <span class="n">test_00_건고추</span><span class="p">[[</span><span class="sh">'</span><span class="s">평균가격(원)</span><span class="sh">'</span><span class="p">]]</span>
</code></pre></div></div>

<h2 id="scaler">Scaler</h2>

<h3 id="minmaxscaler">MinMaxScaler</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># MinMaxScaler를 이용한 스케일링
</span><span class="n">scaler</span> <span class="o">=</span> <span class="nc">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">train_건고추</span><span class="p">)</span>
<span class="n">test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">test_00_건고추</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="dataset">dataset</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 시계열 데이터를 위한 시퀀스 생성 함수
# T-8 ~ T 시점까지 데이터를 가지고 T+1, T+2, T+3 인 시점 예측
</span><span class="k">def</span> <span class="nf">create_sequences</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">seq_length</span> <span class="o">-</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">X</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">seq_length</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">seq_length</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">seq_length</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="model">Model</h1>

<h2 id="lstm">LSTM</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># LSTM 모델 생성
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">LSTM</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">seq_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># T+1, T+2, T+3 예측
</span>
<span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="sh">'</span><span class="s">adam</span><span class="sh">'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">mean_squared_error</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 모델 학습
</span><span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># LSTM에 맞게 데이터 형태 변환
</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 테스트 데이터도 시퀀스 형태로 변환
</span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">test_scaled</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()])</span>  <span class="c1"># 테스트 데이터의 마지막 9개 시점을 입력으로 사용
</span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># 예측 수행
</span><span class="n">predicted</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># 예측값을 원래 스케일로 역변환
</span><span class="n">predicted_prices</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">predicted</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">predicted</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># T+1, T+2, T+3 값을 개별적으로 출력
</span><span class="n">T_plus_1</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">T_plus_2</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">T_plus_3</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="c1"># 결과 출력
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">예측값 (T+1):</span><span class="sh">"</span><span class="p">,</span> <span class="n">T_plus_1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">예측값 (T+2):</span><span class="sh">"</span><span class="p">,</span> <span class="n">T_plus_2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">예측값 (T+3):</span><span class="sh">"</span><span class="p">,</span> <span class="n">T_plus_3</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="전처리부터-모델-학습까지">전처리부터 모델 학습까지</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">condition</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">건고추</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">화건</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">30 kg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">사과</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">홍로</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">후지</span><span class="sh">'</span><span class="p">],</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">10 개</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">감자</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">감자 수미</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">20키로상자</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">배</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">신고</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">10 개</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">깐마늘(국산)</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">깐마늘(국산)</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">20 kg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">무</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">무</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">20키로상자</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">상추</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">청</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">100 g</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상품</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">배추</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">배추</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">10키로망대</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">양파</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">양파</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">1키로</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상</span><span class="sh">'</span>
    <span class="p">},</span>
    <span class="sh">'</span><span class="s">대파</span><span class="sh">'</span> <span class="p">:</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">대파(일반)</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">1키로단</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">등급</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">상</span><span class="sh">'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">condition</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">train_c</span> <span class="o">=</span> <span class="n">train</span><span class="p">[(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">])]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">train_c</span> <span class="o">=</span> <span class="n">train</span><span class="p">[(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">])]</span>
    <span class="n">train_c</span> <span class="o">=</span> <span class="n">train_c</span><span class="p">[[</span><span class="sh">'</span><span class="s">평균가격(원)</span><span class="sh">'</span><span class="p">]]</span>

    <span class="c1"># MinMaxScaler를 이용한 스케일링
</span>    <span class="n">scaler</span> <span class="o">=</span> <span class="nc">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">train_c</span><span class="p">)</span>

    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="nf">create_sequences</span><span class="p">(</span><span class="n">train_scaled</span><span class="p">,</span> <span class="n">seq_length</span><span class="p">)</span>

    <span class="c1"># LSTM 모델 생성
</span>    <span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">LSTM</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">seq_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># T+1, T+2, T+3 예측
</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="sh">'</span><span class="s">adam</span><span class="sh">'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">mean_squared_error</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># 모델 학습
</span>    <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># LSTM에 맞게 데이터 형태 변환
</span>    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">../data/raw_data/test/TEST_</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="mi">02</span><span class="n">d</span><span class="si">}</span><span class="s">.csv</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">])]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">품목명</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">품종명</span><span class="sh">'</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">거래단위</span><span class="sh">'</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sh">'</span><span class="s">등급</span><span class="sh">'</span><span class="p">])]</span>

        <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[[</span><span class="sh">'</span><span class="s">평균가격(원)</span><span class="sh">'</span><span class="p">]]</span>
        <span class="n">test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

        <span class="c1"># 테스트 데이터도 시퀀스 형태로 변환
</span>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">test_scaled</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()])</span>  <span class="c1"># 테스트 데이터의 마지막 9개 시점을 입력으로 사용
</span>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># 예측 수행
</span>        <span class="n">predicted</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># 예측값을 원래 스케일로 역변환
</span>        <span class="n">predicted_prices</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">predicted</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">predicted</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># T+1, T+2, T+3 값을 개별적으로 출력
</span>        <span class="n">T_plus_1</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">T_plus_2</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">T_plus_3</span> <span class="o">=</span> <span class="n">predicted_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="n">sub</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_plus_1</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">sub</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_plus_2</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">sub</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_plus_3</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<h1 id="모델-관련-정리">모델 관련 정리</h1>

<h2 id="rnn">RNN</h2>

<blockquote>
  <p><strong>RNN (Recurrent Neural Network)</strong>는 순환 신경망으로, 시계열 데이터나 연속된 데이터를 처리하기 위해 고안된 신경망 구조<br />
일반적인 인공 신경망(ANN)은 독립적인 입력을 처리하는 반면, RNN은 이전 단계의 정보를 기억하며 그 정보를 다음 단계의 계산에 반영할 수 있다.<br />
RNN의 가장 큰 특징은 순환 구조 -&gt; 네트워크가 <strong>각 타임 스텝(time step)</strong>마다 현재 입력과 <strong>이전의 숨겨진 상태(hidden state)</strong>를 이용해 출력을 계산하는 방식<br />
이를 통해 과거의 정보를 활용할 수 있게 된다.</p>
</blockquote>

<h2 id="lstm-1">LSTM</h2>

<blockquote>
  <p><strong>LSTM (Long Short-Term Memory)</strong>는 RNN의 단점을 보완하기 위해 만들어진 변형된 네트워크<br />
기본 RNN의 경우 <strong>장기 의존성 문제(long-term dependency problem)</strong>가 존재</p>
  <blockquote>
    <p><strong>장기 의존성 문제(long-term dependency problem)</strong> : 시간이 길어지면서 과거의 정보를 잘 기억하지 못하는 현상을 의미</p>
  </blockquote>
</blockquote>

<blockquote>
  <p>LSTM은 이러한 문제를 해결하기 위해 <strong>셀 상태(cell state)</strong>와 <strong>게이트 구조(gates)</strong>를 도입<br />
LSTM은 기억하고자 하는 정보를 선택적으로 유지하거나 버릴 수 있게 하여, <strong>장기 및 단기 메모리(long-term and short-term memory)</strong>를 모두 관리할 수 있다.<br />
이로 인해 LSTM은 긴 시퀀스 데이터에서 중요한 정보를 유지하고, 불필요한 정보를 잊어버리는 방식으로 성능을 향상시킬 수 있다.</p>
</blockquote>

<h3 id="느낀점">느낀점</h3>

<ul>
  <li>RNN 이 이번 공모전 데이터에 더 좋은 성능을 보였다.[같은 파라미터를 사용]</li>
  <li>그 이유는 데이터의 시간이 장기가 아닌 것으로 판단하여 과거의 정보를 잘 기억하여 학습하였다고 생각</li>
</ul>

  </div>
  <div class="md-index">
    <h2>목차</h2>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#데이터ai를-활용한-물가-예측-경진대회-농산물-가격을-중심으로---2024년10월01일">데이터·AI를 활용한 물가 예측 경진대회 농산물 가격을 중심으로 - 2024년10월01일</a></li>
<li class="toc-entry toc-h1"><a href="#문제설명">문제설명</a></li>
<li class="toc-entry toc-h1"><a href="#전처리">전처리</a>
<ul>
<li class="toc-entry toc-h2"><a href="#품목별로-전처리">품목별로 전처리</a>
<ul>
<li class="toc-entry toc-h3"><a href="#건고추">건고추</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#scaler">Scaler</a>
<ul>
<li class="toc-entry toc-h3"><a href="#minmaxscaler">MinMaxScaler</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#dataset">dataset</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#model">Model</a>
<ul>
<li class="toc-entry toc-h2"><a href="#lstm">LSTM</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#전처리부터-모델-학습까지">전처리부터 모델 학습까지</a></li>
<li class="toc-entry toc-h1"><a href="#모델-관련-정리">모델 관련 정리</a>
<ul>
<li class="toc-entry toc-h2"><a href="#rnn">RNN</a></li>
<li class="toc-entry toc-h2"><a href="#lstm-1">LSTM</a>
<ul>
<li class="toc-entry toc-h3"><a href="#느낀점">느낀점</a></li>
</ul>
</li>
</ul>
</li>
</ul>
    <hr>
    <h2>관련 POST</h2>
    
      
        
      
        
      
    
      
        
      
    
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/10/01/%EB%8D%B0%EC%9D%B4%ED%84%B0-AI%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EB%AC%BC%EA%B0%80-%EC%98%88%EC%B8%A1-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%EB%86%8D%EC%82%B0%EB%AC%BC-%EA%B0%80%EA%B2%A9%EC%9D%84-%EC%A4%91%EC%8B%AC%EC%9C%BC%EB%A1%9C.html">데이터·AI를 활용한 물가 예측 경진대회 농산물 가격을 중심으로 [ 2024년10월01일 ]</a>
          </p>
        
      
        
      
    
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/09/26/2024-%EC%83%9D%EB%AA%85%EC%97%B0%EA%B5%AC%EC%9E%90%EC%9B%90-AI%ED%99%9C%EC%9A%A9-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%ED%99%9C%EC%9A%A9-%EB%B6%80%EB%AC%B8.html">2024 생명연구자원 AI활용 경진대회 인공지능 활용 부문-2 [ 2024년09월26일 ]</a>
          </p>
        
      
        
      
        
      
        
      
    
      
        
          <p>
            <a href="/2024/09/12/2024-%EC%83%9D%EB%AA%85%EC%97%B0%EA%B5%AC%EC%9E%90%EC%9B%90-AI%ED%99%9C%EC%9A%A9-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%ED%99%9C%EC%9A%A9-%EB%B6%80%EB%AC%B8.html">2024 생명연구자원 AI활용 경진대회 인공지능 활용 부문-1 [ 2024년09월12일 ]</a>
          </p>
        
      
        
      
        
      
    
      
        
      
        
      
    
  </div>
</div>

<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 56,
  backgroundColor: 'rgb(135, 206, 250)',
  textColor: '#fff'
})</script>

			  </div>
			</div>
			<div class="footer">
  <p>Email : qkrdlstn9701@naver.com</p>
  <a href="https://github.com/insu97">SITE : GITHUB_PAGE</a>
</div>

  </body>
</html>
