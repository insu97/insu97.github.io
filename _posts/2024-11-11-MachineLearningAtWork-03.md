---
layout : markdown
title : Machine Learning At Work - 03
tags : [Machine_Learning_At_Work, Book]
toc : true
---
{% include markdown.html %}

# 학습 결과 평가하기

## 분류 평가

### 정확도

> $$ 정확도 =  \frac{정답과 일치한 수}{전체 데이터 수} $$  
> 현실에서는 분류할 클래스별로 편차가 있는 경우가 많고 단순히 정확도를 적용하는 것은 대부분 큰 의미가 없다.

### 정밀도

> 정밀도 : 출력 결과가 실제로 얼마나 정답이었는가

### 재현울

> 재현율 : 출력 결과가 실제 정답 중 어느 정도의 비율을 차지하는가

```
정밀도와 재현율은 상충관계에 있으며 문제 설정에 따라 중시하는 쪽이 달라진다.  
놓치는 데이터 수가 많더라도 더욱 정확한 예측이 필요하다면 정밀도를 중시
다소 잘못 걸러내는 비율이 높더라도 데이터 누락을 최소화하고자 할 때는 재현율을 중시
```

### F값

> $$ F값 = \frac{2}{\frac{1}{정밀도} + \frac{1}{재현율}} $$  
> 정밀도와 재현율이 균형을 이룰수록 F값은 커진다.

### 혼동행렬

| -- | -- | 예측 | 결과 |
| -- | -- | 양성(스팸) | 음성(스팸 아님) |
| 실제 | 양성(스팸) | 참 양성(TP) | 거짓 음성(FN) |
| 결과 | 음성(스팸 아님) | 거짓 양성(FP) | 참 음성(TN) |

> $$ 정밀도 = \frac{TP}{TP + FP} $$  
> $$ 재현율 = \frac{TP}{TP + FN} $$  

- 다중 클래스 분류 평균 구하기

1. 마이크로 평균
> EX) 3클래스 분류 일 때 :  $$ 정밀도_{마이크로평균} = \frac{TP_{1} + TP_{2} + TP_{3}}{TP_{1} + TP_{2} + TP_{3} + FP_{1} + FP_{2} + FP_{3}} $$
2. 매크로 평균
> $$ 정밀도_{매크로 평균} = \frac{정밀도_{1} + 정밀도_{2} + 정밀도_{3}}{3} $$

### ROC, AUC

> ROC : 참 양성률(TPR)을 세로축, 거짓 양성률(FPR)을 가록축에 그린 것  
> $$ TPR = \frac{TP}{TP + FN} $$  
> $$ FPR = \frac{FP}{FP + TN} $$  
> 참 양성률은 높을수록, 거짓 양성률은 낮을수록 좋다
> AUC : ROC곡선 그래프 아래에 넓이를 더한 값

## 회귀 평가

### 평균제곱근오차(RMSE)

> $$ RMSE = \sqrt{\frac{ \sum_{i}{(예측값_{i}-실제값_{i}})^2}{N} } $$

### 결정계수

> $$ R^2 = 1 - \frac{\sum_{i}{(예측값_{i}-실젯값_{i})^2}}{\sum_{i}{(예측값_{i}-실젯값의 평균_{i})^2}} $$  
> 결정계수가 1에 가까울수록 성능이 좋은 것이며 0에 가까울수록 성능이 좋지 않은 것이다.
