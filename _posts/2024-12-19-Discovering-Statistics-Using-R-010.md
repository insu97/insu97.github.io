---
layout : markdown
title : Discovering Statistics Using R - 010
tags : [Discovering_Statistics_Using_R, R]
toc : true
---

{% include markdown.html %}

# 여러 평균의 비교: 분산분석(GLM 1)

## 분산분석에 깔린 이론

### 상승된 오류율

- 조건이 셋 이상인 상황에서 t 검정을 수행하면 안되는 이유
```
> if 실험 조건이 세 가지이고, 모든 그룹 쌍에 대해 각각 t 검정을 수행한다면, 총 3번의 검정이 필요하다.
> 세 t 검정 모두 .05 수준으로 유의성을 판정한다고 하면, 각 검정에서 제1종 오류를 범하지 않을 확률은 .95이다.
> 만일 세 검정이 독립이라고 하면 제1종 오류를 범하지 않을 전체 확률은 $$.95^3 ==.857 $$ 이다.
> 이 결과로 제1종 오류를 범할 확률은 5% 에서 14.3%로 증가했다.
```
- 집단별 오류 = $$ 1 - (0.95)^n $$ [ n : 자료에 대해 수행한 검정들의 수 ]

### F 값의 해석

- 분산분석은 F 통계량 또는 F-ratio라는 값을 산출한다.
> F는 모형과 오차의 비
- 분산분석은 총괄검정(omnibus test)에 해당한다.
> 즉, 분산분석은 어떤 그룹이 영향을 받았는지에 대한 구체적인 정보를 제공하지 않는다.

### 총제곱합($$SS_T$$)

- $$ SS_T $$ : 관측자료와 Y의 평균의 차이들을 사용

> 관측된 각 자료점과 총평균의 차이를 계산하고 그 차이들을 제곱해서 모두 합한 것  
> $$ SS_T = \sum_{i=1}^{N}{(x_i - \bar{x_총}^2)} $$  
> 분산과 제곱합의 관계가 $$ s^2 = \frac{SS}{N-1} $$ 이므로 $$ SS = s^2(N-1) $$ 이다.

### 모형제곱합($$SS_M$$)

- $$ SS_M $$ = Y의 평균과 모형(그룹 평균)의 차이들을 사용

- 과정
1. 그룹마다 그룹 평균과 총평균의 차이를 계산한다.
2. 그룹마다 그 차이를 제곱한다.
3. 그룹마다 차이 제곱에 그룹의 참가자 수를 곱한다.
4. 각 그룹의 결과를 모두 더한다.

> $$ SS_M = \sum_{n=1}^{k}{(\bar{x}_k - \bar{x}_총)^2} $$

### 잔차제곱합($$SS_R$$)

- $$ SS_R $$ = 관측자료와 모형(그룹 평균)의 차이들을 사용

1. $$ SS_R = SS_T - SS_M $$
2. $$ SS_R = \sum_{i=1}^{n}{(x_{ik} - \bar{x_k}^2)} $$
3. $$ SS_R = \sum{s_k^2(n_k - 1)} $$

### 평균제곱

- $$ MS_M = \frac{SS_M}{df_M} $$ # 모형이 설명하는 변동의 평균량
- $$ MS_R = \frac{SS_R}{df_R} $$ # 가외 변수들이 설명하는 변동의 평균량

### F 비

> 모형이 설명하는 변동과 비체계적 요인들이 설명하는 변동의 비  
> $$ F = \frac{MS_M}{MS_R} $$  

- F 비가 1보다 작다는 것은 해당 모형의 효과는 유의하지 않다는 점
> $$ MS_R > MS_M $$ 이는 곧 비체계적 변동이 체계적 변동보다 많다는 뜻이기 때문  
> 확신을 가지려면 관측된 F비를 그룹 평균들이 같을 전적으로 우연히 얻을 수 있는 최대 F비와 비교해 봐야 한다.
