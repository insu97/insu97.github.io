---
layout : markdown
title : Operating System-02
tags : [Computer_Engineering]
toc : true
---

{% include markdown.html %}

# 프로세스와 스레드

## 커널 영역과 사용자 영역의 프로세스

- 프로세스 : 실행 중인 프로그램

- 프로세스 제어 블록(PCB)
> PID(PPID), 레지스터, 스케줄링 정보, 메모리 정보, 사용한 파일 정보, 입출력장치 정보

- 문맥 : 실행을 재개하기 위한 기억해야 할 정보
- 문맥 교환 : 여러 프로세스들이 번갈아가며 실행되는 원리

- 코드 영역(텍스트 영역) : 실행 가능한 코드; 기계어로 이루어진 명령어
- 데이터 영역 : 프로그램이 실행되는 동안 유지할 데이터; BSS 영역 : 프로그램 실행 동안 유지할 데이터 중 초기값 없는 데이터
- 힙 영역 : 사용자(개발자)가 직접 할당 가능한 영역; 메모리 영역을 할당 했다면 해제하기[직접, 자동으로 설정] -> 안했다면 메모리 누수 발생
> 낮은 주소에서 높은 주소로 할당
- 스택 영역 : 임시로 저장되는 영역; 높은 주소에서 낮은 주소로 할당(주소 중복 방지)

## 프로세스 생성과 상태

- 대표적인 프로세스 상태
1. 생성 상태(new)
2. 준비 상태(ready) : W(Waiting)
3. 실행 상태(running) : R(Running)
4. 대기 상태(blocked) : S(Sleeping)
5. 종료 상태(terminated) : S(Stopped)
> Z : Zombie = 프로세스 종료 후 자원이 반환되었지만 커널 영역에 프로세스가 남아있는 상태

- fork-exec : 계층적 구조로 프로세스가 생성되는 원리
> fork : 복사본 만들기  
> exec : 새로운 코드로 대체(덮어쓰기)

## 스레드

> 프로세스를 구성하는 실행 흐름의 단위  
> 각기 다른 스레드 ID, 프로그램 카운터, 레지스터, 스택

- 프로세스 간에는 기본적으로 자원을 공유하지 않음
- 스레드 간에는 프로세스의 자원을 공유

# CPU 스케줄링

## 프로세스 우선순위와 스케줄링 큐

> CPU 스케줄링 ; 운영체제가 공정하고 합리적으로 CPU를 배분하는 방법

- 대표적인 스케줄링 큐
1. 준비 큐 : CPU 이용을 기다리는 프로세스들의 큐
2. 대기 큐 : 대기 상태 프로세스들의 큐 ( 입출력 요청 )

- 선점형 스케줄링
> 프로세스에 자원을 고루 할당 가능  
> 문맥 교환 과정의 오버헤드
- 비선점형 스케줄링
> 고르지 않은 자원 분배   
> 문맥 교환 과정에서의 오버헤드 적음

## CPU 스케줄링 알고리즘

1. 선입 선처리 스케줄링(FIFO) : CPU를 먼저 요청한 프로세스부터 CPU할당, 준비 큐에 삽입된 순서대로 실행되는 비선점형 스케줄링
2. 최단 작업 우선 스케줄링 : 준비 큐 프로세스 중 CPU 이용 시간이 짧은 프로세스부터 실행, 호위효과 방지
3. 라운드 로빈 스케줄링 : 선입 선처리 스케줄링 + 타임 슬라이스, 준비 큐에 삽입된 순서로 실행하되, 타임 슬라이스만큼 실행, 선점형 스케줄링
4. 최소 잔여 시간 우선 스케줄링(SRT) : 최단 작업 우선 스케줄링 + 라운드 로빈 스케줄링, 작업 시간 짧은 프로세스부터 처리하되 타임 슬라이스만큼 돌아감
5. 우선순위 스케줄링 : 프로세스마다 우선순위 부여, 우선순위 높은 순으로 스케줄링
> 아사(starvation) 현상 : 우선순위 낮은 프로세스의 실행이 계속 연기되는 현상    
> 해결책 : 에이징(aging) = 대기 시간이 길어지면 점차 우선순위를 높이는 방식  
6. 다단계 큐 스케줄링 : 우선순위 별로 준비 큐를 여러 개 사용하는 스케줄링
7. 다단계 피드백 큐 스케줄링 : 높은 우선순위 큐에 삽입, 실행이 끝나지 않을 경우 낮은 우선순위 큐에 삽입

## 리눅스의 스케줄링

- 실시간 정책 스케줄링[우선순위 높음]
> SCHED_FIFO  
> SCHED_RR

- 일반 정책 스케줄링[우선순위 낮음]
> SCHED_OTHER/SCHED NORMAL  
> SCHED_BATCH  
> SCHED_IDLE

- CFS(Completely Fair Scheduler)
> 비실시간 프로세스를 대상으로 하는 스케줄링 방식  
> vruntime(virtual runtime) : 프로세스가 그 동안 실행한 시간을 정규화한 정보  
> vruntime 이 작은 프로세스를 다음 실행할 프로세스로 삼음
