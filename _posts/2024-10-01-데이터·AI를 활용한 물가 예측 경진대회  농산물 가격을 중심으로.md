---
layout : markdown
title : 데이터·AI를 활용한 물가 예측 경진대회  농산물 가격을 중심으로
tags : [dacon]
toc : true
---
{% include markdown.html %}

- site : [Dacon_site](https://www.dacon.io/competitions/official/236381/overview/description)
- 기간 : 2024-10-01 ~ 2024-10-14

---

# 문제설명

1. train_data : 2018 ~ 2021년의 순 단위(10일)
2. test_data : 추론 시점 T가 비식별화된 2022년의 순 단위의 데이터
3. sub_data : 추론 시점 T 기준으로 T+1순, T+2순, T+3순의 평균가격을 예측하여 제출

- 조건  
![image](/assets/images/dacon/Dacon_002.png)

# 전처리

## 품목별로 전처리

### 건고추

- 건고추

```python
train = pd.read_csv("../data/raw_data/train/train.csv")

train_건고추 = train[(train['품목명'] == '건고추') & (train['품종명'] == '화건') & (train['거래단위'] == '30 kg') & (train['등급'] == '상품')]

train_건고추 = train_건고추[['평균가격(원)']]
```

```python
test_00 = pd.read_csv("../data/raw_data/test/TEST_00.csv")

test_00_건고추 = test_00[(test_00['품목명'] == '건고추') & (test_00['품종명'] == '화건') & (test_00['거래단위'] == '30 kg') & (test_00['등급'] == '상품')]

test_00_건고추 = test_00_건고추[['평균가격(원)']]
```

## Scaler

### MinMaxScaler

```python
# MinMaxScaler를 이용한 스케일링
scaler = MinMaxScaler(feature_range=(0, 1))
train_scaled = scaler.fit_transform(train_건고추)
test_scaled = scaler.fit_transform(test_00_건고추)
```

## dataset

```python
# 시계열 데이터를 위한 시퀀스 생성 함수
# T-8 ~ T 시점까지 데이터를 가지고 T+1, T+2, T+3 인 시점 예측
def create_sequences(data, seq_length):
    X = []
    y = []
    for i in range(len(data) - seq_length - 3):
        X.append(data[i:i+seq_length, 0])
        y.append(data[i+seq_length:i+seq_length+3, 0])
    return np.array(X), np.array(y)
```

# Model

## LSTM

```python
# LSTM 모델 생성
model = Sequential()
model.add(LSTM(units=50, return_sequences=False, input_shape=(seq_length, 1)))
model.add(Dense(3))  # T+1, T+2, T+3 예측

model.compile(optimizer='adam', loss='mean_squared_error')

# 모델 학습
X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1))  # LSTM에 맞게 데이터 형태 변환
model.fit(X_train, y_train, epochs=20, batch_size=32)
```

```python
# 테스트 데이터도 시퀀스 형태로 변환
X_test = np.array([test_scaled.flatten()])  # 테스트 데이터의 마지막 9개 시점을 입력으로 사용
X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))

# 예측 수행
predicted = model.predict(X_test)
# 예측값을 원래 스케일로 역변환
predicted_prices = scaler.inverse_transform(np.concatenate((predicted, np.zeros((predicted.shape[0], 1))), axis=1))[:, :3]

# T+1, T+2, T+3 값을 개별적으로 출력
T_plus_1 = predicted_prices[0, 0]
T_plus_2 = predicted_prices[0, 1]
T_plus_3 = predicted_prices[0, 2]

# 결과 출력
print("예측값 (T+1):", T_plus_1)
print("예측값 (T+2):", T_plus_2)
print("예측값 (T+3):", T_plus_3)
```

# 해야할 일

1. Baseline 코드 뜯어보기
2. train_data 전처리
> 위 사진에 부합하는 데이터만 남기기
3. test_data 는 어떻게 처리해야 하는지 고민
4. sub_data 에 어떻게 예측할지 생각 [ 시계열 모델 , 회귀분석 ]
