---
layout : markdown
title : Machine Learning At Work - 08
tags : [Machine_Learning_At_Work, Book]
toc : true
---
{% include markdown.html %}

# 머신러닝 모델 해석하기

```
비즈니스 환경에서는 예측 결과를 상사나 클라이언트, 사용자에게 설명해야 할 때가 있다.
예측 이유는 무엇이며 어떤 특징량이 기여하는지, 어떤 특징량을 조합하면 더 나은 예측이 가능한지 등이다.
예측 이유와 사람의 직감이 일치하는지 판단해 예측 모델의 타당성을 평가한다.
```

> 유명한 논문 [Grad-CAM](https://arxiv.org/abs/1610.02391)


## 회귀

1. 목적 변수와 숫자 타입을 추출한다.
> 한 종류의 값만 갖는 열은 예측에 사용할 수 없으니 버린다.  
> 개인을 특정할 수 있는 특징량(EX. 임직원번호)은 과적합의 원인이 되어 제거한다.  
> 범주 타입 데이터를 원-핫 인코딩한 뒤 숫자 타입과 결합하여 데이터프레임을 만든다.
2. 데이터를 만들었으니 상관행렬을 확인해 데이터의 경향을 파악한다.
3. 선형 회귀 계수를 이용한 원인 해석
> 절편(intercept)의 값은 다른 계수에 따라 달라져 우선은 무시  
> Min-Max scaler를 활용해서 데이터를 0~1의 영역으로 정규화한 뒤 확인하기  
> 회귀 계수의 값이 발산했다면 다중공선성 때문이다.  
> 다중공선성 : 한 특징량이 다른 특징량과 매우 비슷해 예측 가능한 상태에 있음을 의미  
> 이를 해결하기 위한 한가지 방법은 pd.get_dummies를 할 때 drop_first 옵션을 활성화하면 원-핫 인코딩을 할 때 한 종류의 데이터를 버리고 n-1 종류의 데이터로 만들 수 있다.  
> 다중공선성이 있는 데이터에서는 회귀 계수가 커지는 과적합이 쉽게 일어나 라쏘, 릿지, 일레스틱넷과 같이 정규항을 추가해 회귀 계수가 커지는 것을 억제하는 선형 회귀 알고리즘을 사용한다.  
4. 회귀 계수 p값 구하기
> p값이 큰 특징량은 목적 변수에 기여하지 않는다고 판단한다.

## 분류

> 분류 원인 분석 중 DecisionTree or dtreeviz를 사용해서 시각화해서 볼 수 있다.

```
shap은 분류 모델은 회귀 모델로 사용할 수도 있지만, 목적 변수가 이진값이면 회귀 모델로 입력하는 것이 시각화가 잘 된다
```
