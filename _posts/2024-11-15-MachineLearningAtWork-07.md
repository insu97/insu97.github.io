---
layout : markdown
title : Machine Learning At Work - 07
tags : [Machine_Learning_At_Work, Book]
toc : true
---
{% include markdown.html %}

# 효과 검증: 머신러닝 기반 정책 성과 판단하기

## 효과 검증

- 비즈니스 지표를 이용한 정책 평가
> 팀 내부에서 공유할 때는 '이 기능을 출시하면 예측 정확도가 향상된다.'정도로 충분하지만  
> 팀 외부로 보고할 때는 예측 정확도가 향상되면 무엇이 좋아지는지 설명해야한다.

- 정책을 실행한 후의 효과 검증의 필요성

- 오프라인 검증과 온라인 검증
> 오프라인 검증 : 과거 데이터를 사용해 시뮬레이션  
> 온라인 검증 : 실제 제품에 머신러닝을 적용해 실험을 수행

- 지표 선정

## 인과 효과 추정

- 상관관계와 인과관계
> 상관관계가 있다고 해서 반드시 인과관계가 있는 것은 아니다

- 루빈의 인과관계 모델
> EX. 인터넷 광고의 효과  
> 인과 추론에서는 광고를 보여주는 것  
> 구매 행동을 결과 변수  
> 개입한 표본을 개입군 또는 실험군  
> 개입하지 않은 표본을 대조군 또는 통제군

- 선택 편향에 의한 위장 효과
> 구하고자 하는 평균 처리 효과를 계산할 때는 '개입군의 결과 변수의 평균'과 '대조군의 결과 변수의 평균'의 차를 구하면 충분  
> 선택 편향은 개입과 결과 변수 사이에 상관관계를 만들어 효과가 없음에도 효과가 있는 듯 보이는 데이터가 된다.

- 무작위 비교 시험(Randomized Control Trial, RCT)
> 편향이 없는 상태를 만들어서 비교하는 방법

- 과거와 비교한 판단

## 가설 검정 프레임
> 가설 검정 : A/B TEST에 기반한 표본(샘플)을 사용해 모집단을 판단하는 기법

- 거짓 양성과 거짓 음성
> 드물게 발생하는 일이 발생하면 귀무 가설을 기각한다고 판단하면 귀무가설이 참이라고 해도 유의 수준의 확률에 따라 귀무가설을 잘못 기각할 수 있다.  
> 이처럼 잘못된 발견을 거짓 양성이라고 한다.  
> 반대로 실제로는 유의한 차이가 있지만 귀무가설을 기각하지 않는 경우를 거짓 음성이라고 한다.

## A/B TEST 설계 및 수행

- 과정
1. 지표 선정
2. 두 그룹 선정
3. A/A 테스트 : 무작위 추출에 따라 품질이 같은 두 그룹을 얻었는지 확인하는 것
4. 한 그룹에 개입
5. 결과 확인
6. 테스트 종료

## 오프라인 검증

- 비즈니스 지표를 사용한 예측 모델 평가
> 예측 모델 정확도가 비즈니스 지표에 미치는 영향을 알기는 어렵지만 예측을 기반으로 행동한 결과를 고려하면 더욱 쉽게 알 수 있다.

- 반사실 다루기
> 분명하지 않은 결과를 다룰 때 가장 편한 방법은 상환 역략을 예측하고 이를 이용한 결과를 만들어 평가하는 것

- Off Policy Evaluation
> 효과 검증에서 중요한 점은 예측 모델의 출력 자체가 아니라 예측으로 어떤 행동을 하는 시스템 관점에서의 성능  
> OPE : 과거의 다른 정책에 따라 생성한 로그에 기반해 행동 결정 정책을 평가하는 것

## A/B TEST를 수행할 수 없을 경우

- 관찰 데이터를 사용한 효과 검증
> 차이의 차이 기법 : 실험군과 유사한 경향을 나타내는 그룹의 결과 변수의 시간 변화를 활용해 개입 전후를 비교하는 기법
